(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    302890,       9405]
NotebookOptionsPosition[    295463,       9159]
NotebookOutlinePosition[    295869,       9176]
CellTagsIndexPosition[    295826,       9173]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.540575535703224*^9, 3.540575537165615*^9}, 
   3.540752350738008*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expand", "=", 
   RowBox[{
    RowBox[{"NonCommutativeMultiply", "[", " ", 
     RowBox[{"x___", ",", 
      RowBox[{"Plus", "[", 
       RowBox[{"y_", ",", "z_", ",", "w_"}], "]"}], ",", "v___"}], "]"}], 
    "\[Rule]", " ", 
    RowBox[{"Plus", "[", 
     RowBox[{
      RowBox[{"NonCommutativeMultiply", "[", " ", 
       RowBox[{"x", ",", "y", ",", "v"}], "]"}], " ", "+", " ", 
      RowBox[{"NonCommutativeMultiply", "[", 
       RowBox[{"x", ",", "z", ",", "v"}], "]"}], " ", "+", " ", 
      RowBox[{"NonCommutativeMultiply", "[", 
       RowBox[{"x", ",", "w", ",", "v"}], "]"}]}], "]"}]}]}], ";"}]], "Input",\

 CellFrame->True,
 CellChangeTimes->{{3.540735208179511*^9, 3.540735220177161*^9}, {
  3.540735368939138*^9, 3.540735369455997*^9}}],

Cell["Test the substititution rule \"expand\"", "Text",
 CellChangeTimes->{{3.5407354630074167`*^9, 3.5407354670133*^9}, {
  3.540735602571944*^9, 3.5407356193385344`*^9}, {3.6019521751140704`*^9, 
  3.6019521762641363`*^9}},
 Background->GrayLevel[0.85]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"y", "**", 
   RowBox[{"(", 
    RowBox[{"a", " ", "+", " ", "b", " ", "+", " ", "w"}], ")"}], "**", "x"}],
   "/.", "expand"}]], "Input",
 CellChangeTimes->{{3.540735266534767*^9, 3.540735269632188*^9}, {
  3.5407353002439003`*^9, 3.54073533280567*^9}, {3.540735400319778*^9, 
  3.5407354239604816`*^9}, {3.5407354809847097`*^9, 3.5407354811678333`*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{"y", "**", "a", "**", "x"}], "+", 
  RowBox[{"y", "**", "b", "**", "x"}], "+", 
  RowBox[{"y", "**", "w", "**", "x"}]}]], "Output",
 CellChangeTimes->{
  3.540735270694881*^9, {3.5407353173059464`*^9, 3.540735335254116*^9}, {
   3.540735374786642*^9, 3.5407354263962317`*^9}, 3.540735484062564*^9, 
   3.540748835386669*^9, 3.5407497129924793`*^9, 3.540750486512567*^9, 
   3.5407506985082703`*^9, 3.5407515525189753`*^9, 3.5407522748727407`*^9, {
   3.540752332268814*^9, 3.540752357836286*^9}, 3.5407544444243393`*^9, 
   3.540760264955749*^9, 3.540824283789091*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"y", "**", 
   RowBox[{"(", 
    RowBox[{"a", " ", "+", " ", "b", " ", "+", " ", "w"}], ")"}]}], "/.", 
  "expand"}]], "Input",
 CellChangeTimes->{{3.5407355049904327`*^9, 3.540735521280905*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{"y", "**", "a"}], "+", 
  RowBox[{"y", "**", "b"}], "+", 
  RowBox[{"y", "**", "w"}]}]], "Output",
 CellChangeTimes->{
  3.540735522248735*^9, 3.540748835423135*^9, 3.5407497130460978`*^9, 
   3.540750486565914*^9, 3.540750698561331*^9, 3.540751552571907*^9, 
   3.540752274925922*^9, {3.540752332322803*^9, 3.540752357888502*^9}, 
   3.540754444476983*^9, 3.540760265008562*^9, 3.540824283855596*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a", "+", "b", "+", "w"}], ")"}], "**", "y"}], "/.", 
  "expand"}]], "Input",
 CellChangeTimes->{{3.540735528289795*^9, 3.5407355418816223`*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "**", "y"}], "+", 
  RowBox[{"b", "**", "y"}], "+", 
  RowBox[{"w", "**", "y"}]}]], "Output",
 CellChangeTimes->{
  3.540735542888888*^9, 3.540748835473646*^9, 3.540749713096538*^9, 
   3.540750486615567*^9, 3.540750698611239*^9, 3.540751552638632*^9, 
   3.540752274993696*^9, {3.540752332372414*^9, 3.5407523579381638`*^9}, 
   3.540754444544202*^9, 3.540760265058329*^9, 3.540824283909234*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a", "+", "b", "+", "w"}], ")"}], "**", 
   RowBox[{"(", 
    RowBox[{"m", "+", "n", "+", "k"}], ")"}]}], "//.", "expand"}]], "Input",
 CellChangeTimes->{{3.540735545682209*^9, 3.540735574693637*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "**", "k"}], "+", 
  RowBox[{"a", "**", "m"}], "+", 
  RowBox[{"a", "**", "n"}], "+", 
  RowBox[{"b", "**", "k"}], "+", 
  RowBox[{"b", "**", "m"}], "+", 
  RowBox[{"b", "**", "n"}], "+", 
  RowBox[{"w", "**", "k"}], "+", 
  RowBox[{"w", "**", "m"}], "+", 
  RowBox[{"w", "**", "n"}]}]], "Output",
 CellChangeTimes->{{3.540735564405694*^9, 3.540735577306539*^9}, 
   3.540748835523822*^9, 3.540749713146083*^9, 3.540750486665716*^9, 
   3.5407506986618567`*^9, 3.54075155270542*^9, 3.5407522750596113`*^9, {
   3.540752332422832*^9, 3.540752357988728*^9}, 3.540754444594536*^9, 
   3.540760265109236*^9, 3.540824283959259*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"2", "**", 
   RowBox[{"(", 
    RowBox[{"i", "+", "j", "+", "k"}], ")"}], "**", 
   RowBox[{"(", 
    RowBox[{"u", "+", "v", "+", "w"}], ")"}], "**", 
   RowBox[{"(", 
    RowBox[{"x", "+", "y", "+", "z"}], ")"}], "**", "9"}], "//.", 
  "expand"}]], "Input",
 CellChangeTimes->{{3.540735652584206*^9, 3.540735682264167*^9}, {
  3.540735780341194*^9, 3.540735785554717*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", "**", "i", "**", "u", "**", "x", "**", "9"}], "+", 
  RowBox[{"2", "**", "i", "**", "u", "**", "y", "**", "9"}], "+", 
  RowBox[{"2", "**", "i", "**", "u", "**", "z", "**", "9"}], "+", 
  RowBox[{"2", "**", "i", "**", "v", "**", "x", "**", "9"}], "+", 
  RowBox[{"2", "**", "i", "**", "v", "**", "y", "**", "9"}], "+", 
  RowBox[{"2", "**", "i", "**", "v", "**", "z", "**", "9"}], "+", 
  RowBox[{"2", "**", "i", "**", "w", "**", "x", "**", "9"}], "+", 
  RowBox[{"2", "**", "i", "**", "w", "**", "y", "**", "9"}], "+", 
  RowBox[{"2", "**", "i", "**", "w", "**", "z", "**", "9"}], "+", 
  RowBox[{"2", "**", "j", "**", "u", "**", "x", "**", "9"}], "+", 
  RowBox[{"2", "**", "j", "**", "u", "**", "y", "**", "9"}], "+", 
  RowBox[{"2", "**", "j", "**", "u", "**", "z", "**", "9"}], "+", 
  RowBox[{"2", "**", "j", "**", "v", "**", "x", "**", "9"}], "+", 
  RowBox[{"2", "**", "j", "**", "v", "**", "y", "**", "9"}], "+", 
  RowBox[{"2", "**", "j", "**", "v", "**", "z", "**", "9"}], "+", 
  RowBox[{"2", "**", "j", "**", "w", "**", "x", "**", "9"}], "+", 
  RowBox[{"2", "**", "j", "**", "w", "**", "y", "**", "9"}], "+", 
  RowBox[{"2", "**", "j", "**", "w", "**", "z", "**", "9"}], "+", 
  RowBox[{"2", "**", "k", "**", "u", "**", "x", "**", "9"}], "+", 
  RowBox[{"2", "**", "k", "**", "u", "**", "y", "**", "9"}], "+", 
  RowBox[{"2", "**", "k", "**", "u", "**", "z", "**", "9"}], "+", 
  RowBox[{"2", "**", "k", "**", "v", "**", "x", "**", "9"}], "+", 
  RowBox[{"2", "**", "k", "**", "v", "**", "y", "**", "9"}], "+", 
  RowBox[{"2", "**", "k", "**", "v", "**", "z", "**", "9"}], "+", 
  RowBox[{"2", "**", "k", "**", "w", "**", "x", "**", "9"}], "+", 
  RowBox[{"2", "**", "k", "**", "w", "**", "y", "**", "9"}], "+", 
  RowBox[{"2", "**", "k", "**", "w", "**", "z", "**", "9"}]}]], "Output",
 CellChangeTimes->{
  3.540735683926075*^9, 3.5407357882739162`*^9, 3.540748835574421*^9, 
   3.5407497131970863`*^9, 3.540750486716929*^9, 3.540750698712614*^9, 
   3.5407515527566*^9, 3.540752275110569*^9, {3.540752332487764*^9, 
   3.5407523580540323`*^9}, 3.540754444645193*^9, 3.540760265159947*^9, 
   3.540824284010302*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[TextData[{
 "Get rid of ** in the places where they are not supposed to appear, ** are \
only supposed to appear on left and right side of P and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["P", "\[Dagger]"], TraditionalForm]]],
 ". "
}], "Text",
 CellChangeTimes->{{3.5405844833531733`*^9, 3.540584497127301*^9}, {
  3.540669276841515*^9, 3.540669310646854*^9}, {3.5406701593951*^9, 
  3.5406701914573193`*^9}, {3.540674297921886*^9, 3.540674298622671*^9}, {
  3.601952186859742*^9, 3.6019521881578164`*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"P", " ", "and", " ", 
    RowBox[{"Pdag", " ", "'"}], "s", " ", "first", " ", "element", " ", "is", 
    " ", "P"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ourtest", "[", "x_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "x", "]"}], "\[Equal]", "1"}], ")"}], "&&", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=",
            "P"}], ")"}]}], " ", ")"}], "||", 
       RowBox[{"IntegerQ", "[", "x", "]"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "\[Equal]", "\[Delta]"}], ")"}]}], ",", " ", "True", ",", " ", 
      "False"}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"when", " ", "you", " ", "use"}], " ", "&&", " ", "and"}], " ",
       "||"}], ",", " ", 
     RowBox[{"remember", " ", "to", " ", "add", " ", 
      RowBox[{"brackets", "!!"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"clean", "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NonCommutativeMultiply", "[", 
       RowBox[{"x___", ",", 
        RowBox[{"u_", "/;", 
         RowBox[{"ourtest", "[", "u", "]"}]}], ",", "y___"}], "]"}], 
      "\[RuleDelayed]", "  ", 
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"NonCommutativeMultiply", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", "u"}], "]"}]}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "we", " ", "want", " ", "to", " ", "get", " ", "rid", " ", "of", " ", 
      "\"\<**\>\"", " ", "in", " ", "places", " ", "where", " ", "they", " ", 
      "are", " ", "not", " ", "supposed", " ", "to", " ", "appear"}], " ", 
     "*)"}]}]}]}]], "Input",
 CellFrame->True,
 CellChangeTimes->{{3.540668644601039*^9, 3.540668655505517*^9}, {
   3.5406687673343983`*^9, 3.540668839233451*^9}, {3.54066888348748*^9, 
   3.540668896099758*^9}, {3.540668948904516*^9, 3.5406689672861013`*^9}, {
   3.540670589996538*^9, 3.54067062607229*^9}, {3.5406706949317217`*^9, 
   3.540670698801428*^9}, {3.540670853521695*^9, 3.5406708827609243`*^9}, {
   3.540670996430997*^9, 3.5406709998611*^9}, {3.540671219930044*^9, 
   3.54067129088689*^9}, {3.5406713564446697`*^9, 3.54067141513516*^9}, 
   3.5406716334057503`*^9, {3.5406716668796883`*^9, 3.5406717056989727`*^9}, {
   3.5406717612318296`*^9, 3.540671765108327*^9}, 3.540671966363151*^9, {
   3.5406720257631493`*^9, 3.540672048401029*^9}, {3.540672103446553*^9, 
   3.540672144820607*^9}, {3.540672363768032*^9, 3.540672396878623*^9}, {
   3.5406724435061502`*^9, 3.540672455583425*^9}, {3.540672559179147*^9, 
   3.5406725911642303`*^9}, {3.5406727167827806`*^9, 
   3.5406727213061743`*^9}, {3.540672754541885*^9, 3.540672778243476*^9}, {
   3.540673041303195*^9, 3.5406730979892483`*^9}, 3.540673420243815*^9, {
   3.5406735321448402`*^9, 3.5406736232934637`*^9}, {3.540673733818179*^9, 
   3.5406737988873253`*^9}, {3.5406738298167877`*^9, 3.540673832886714*^9}, {
   3.540673863842205*^9, 3.540673869552609*^9}, {3.540673920261916*^9, 
   3.54067398397128*^9}, {3.54067402493396*^9, 3.540674026020702*^9}, {
   3.540674126677433*^9, 3.540674168453703*^9}, {3.540674223015004*^9, 
   3.540674262828155*^9}, {3.54073276153899*^9, 3.540732764018455*^9}, {
   3.540732794363838*^9, 3.540732831050867*^9}, {3.6019522662962856`*^9, 
   3.601952301155279*^9}}],

Cell["Test the substitution rule \"clean\"", "Text",
 CellChangeTimes->{{3.540735850939897*^9, 3.540735860546301*^9}, {
  3.6019522231588182`*^9, 3.6019522242748823`*^9}},
 Background->GrayLevel[0.85]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox["P", "m"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}], "//.", 
  "clean"}]], "Input",
 CellChangeTimes->{{3.540735906607855*^9, 3.540735909013785*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
  SubscriptBox["P", "n"], "**", 
  SubscriptBox["P", "m"], "**", 
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}]], "Output",
 CellChangeTimes->{
  3.540735909944503*^9, 3.54074883572139*^9, 3.540749713378151*^9, 
   3.540750486997966*^9, 3.540750698977888*^9, 3.540751552920401*^9, 
   3.5407522752069883`*^9, {3.5407523326179667`*^9, 3.5407523581843033`*^9}, 
   3.540754444740776*^9, 3.5407602652394114`*^9, 3.540824284090996*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox["P", "m"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
   RowBox[{"(", 
    RowBox[{"-", "2"}], ")"}]}], "//.", "clean"}]], "Input",
 CellChangeTimes->{{3.5407359171681356`*^9, 3.540735925574897*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", 
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox["P", "m"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}]}]], "Output",
 CellChangeTimes->{
  3.5407359263798733`*^9, 3.540748835757408*^9, 3.5407497134303226`*^9, 
   3.540750487067021*^9, 3.540750699045885*^9, 3.540751553024906*^9, 
   3.540752275259838*^9, {3.540752332671809*^9, 3.540752358237818*^9}, 
   3.540754444794496*^9, 3.5407602652923603`*^9, 3.5408242841444807`*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox["P", "m"], "**", 
   RowBox[{"(", 
    RowBox[{"-", "2"}], ")"}], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}], "//.", 
  "clean"}]], "Input",
 CellChangeTimes->{{3.540735931760683*^9, 3.540735948239588*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", 
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox["P", "m"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}]}]], "Output",
 CellChangeTimes->{
  3.5407359490892677`*^9, 3.54074883579156*^9, 3.5407497135503883`*^9, 
   3.540750487116539*^9, 3.540750699096283*^9, 3.5407515530732718`*^9, 
   3.5407522753272333`*^9, {3.540752332721806*^9, 3.540752358288457*^9}, 
   3.540754444844759*^9, 3.54076026534273*^9, 3.540824284194709*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"2", "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox["P", "m"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}], "//.", 
  "clean"}]], "Input",
 CellChangeTimes->{{3.540735960633717*^9, 3.5407359659045067`*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox["P", "m"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}]}]], "Output",
 CellChangeTimes->{
  3.540735966651947*^9, 3.5407488358405724`*^9, 3.540749713597384*^9, 
   3.540750487166892*^9, 3.5407506991460733`*^9, 3.540751553107288*^9, 
   3.5407522753764963`*^9, {3.540752332771348*^9, 3.5407523583379507`*^9}, 
   3.540754444894414*^9, 3.540760265392355*^9, 3.54082428424585*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], "**", 
   SubscriptBox["P", "m"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}], "//.", 
  "clean"}]], "Input",
 CellChangeTimes->{{3.5407359947482758`*^9, 3.540736000665392*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox["P", "m"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}], " ", 
  SubscriptBox["\[Delta]", 
   RowBox[{"m", ",", "n1"}]]}]], "Output",
 CellChangeTimes->{
  3.540736001423173*^9, 3.540748835890296*^9, 3.5407497136472273`*^9, 
   3.540750487217577*^9, 3.5407506991962337`*^9, 3.540751553156516*^9, 
   3.5407522754446507`*^9, {3.540752332821439*^9, 3.5407523583883867`*^9}, 
   3.540754444944717*^9, 3.540760265442193*^9, 3.5408242842955227`*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", "7", "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], "**", 
   SubscriptBox["P", "m"], "**", "2", "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}], "//.", 
  "clean"}]], "Input",
 CellChangeTimes->{{3.5407360142201443`*^9, 3.5407360320027857`*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{"14", " ", 
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox["P", "m"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}], " ", 
  SubscriptBox["\[Delta]", 
   RowBox[{"m", ",", "n1"}]]}]], "Output",
 CellChangeTimes->{{3.540736020061182*^9, 3.5407360347304573`*^9}, 
   3.540748836022459*^9, 3.54074971369722*^9, 3.540750487267337*^9, 
   3.540750699246085*^9, 3.5407515532061977`*^9, 3.5407522754939537`*^9, {
   3.540752332871544*^9, 3.54075235843792*^9}, 3.540754444995522*^9, 
   3.540760265493327*^9, 3.540824284346328*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"deletezero", "=", 
  RowBox[{
   RowBox[{"NonCommutativeMultiply", "[", 
    RowBox[{"x___", ",", 
     SubscriptBox["P", "_"]}], "]"}], " ", "\[Rule]", " ", "0"}]}]], "Input",
 CellChangeTimes->{{3.540736434858243*^9, 3.540736449759465*^9}, 
   3.5407368886021852`*^9, {3.540736921065522*^9, 3.540736925487245*^9}, 
   3.5407370112201767`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"x___", "**", 
   SubscriptBox["P", "_"]}], "\[Rule]", "0"}]], "Output",
 CellChangeTimes->{
  3.5407370131982727`*^9, 3.5407488363231783`*^9, 3.540749714011386*^9, 
   3.5407504876311007`*^9, 3.540750699593874*^9, 3.540751553520494*^9, 
   3.540752275560588*^9, {3.540752332921548*^9, 3.540752358488253*^9}, 
   3.540754445045465*^9, 3.5407602655429*^9, 3.5408242843963223`*^9}]
}, Open  ]],

Cell["Test the above rule", "Text",
 CellChangeTimes->{{3.540736458559648*^9, 3.540736483576447*^9}, {
  3.6019523277438*^9, 3.601952329019873*^9}},
 Background->GrayLevel[0.85]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "/.", "deletezero"}]], "Input",
 CellChangeTimes->{{3.540736494755739*^9, 3.540736501547072*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.540736503540854*^9, 3.54073689574622*^9, 3.540736934958004*^9, 
   3.540748836375291*^9, 3.540749714048012*^9, 3.540750487685254*^9, 
   3.540750699646542*^9, 3.540751553557583*^9, 3.540752275627946*^9, {
   3.5407523329717197`*^9, 3.540752358537939*^9}, 3.540754445095508*^9, 
   3.5407602655932703`*^9, 3.540824284447007*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
   SubscriptBox["P", "m"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], "/.", 
  "deletezero"}]], "Input",
 CellChangeTimes->{{3.540736679393696*^9, 3.540736684148027*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{"0", "**", 
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}]], "Output",
 CellChangeTimes->{
  3.54073668545514*^9, 3.540736906075433*^9, {3.540736950602519*^9, 
   3.540736970788842*^9}, 3.540748836408905*^9, 3.5407497140973997`*^9, 
   3.540750487735311*^9, 3.5407506996967*^9, 3.5407515536068363`*^9, 
   3.5407522756945667`*^9, {3.540752333022709*^9, 3.540752358589012*^9}, 
   3.5407544451456137`*^9, 3.540760265642939*^9, 3.5408242844972477`*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell["\<\
Clearly, the above substitution rule doesn't produce the result we want. \
Let's try to restrict the rule to be applied only in the first level\
\>", "Text",
 CellChangeTimes->{{3.5407371933600903`*^9, 3.540737222870509*^9}, {
  3.540737430375332*^9, 3.5407374830787163`*^9}},
 Background->GrayLevel[0.85]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Replace", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], ",", "deletezero", 
   ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.5407374034528646`*^9, 3.540737420857429*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
  SubscriptBox["P", "n"], "**", 
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
  SubscriptBox["P", "m"], "**", 
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}]], "Output",
 CellChangeTimes->{
  3.540737422913356*^9, 3.5407488364580317`*^9, 3.540749714148488*^9, 
   3.5407504877868853`*^9, 3.54075069974986*^9, 3.540751553657346*^9, 
   3.540752275743792*^9, {3.540752333072266*^9, 3.540752358638913*^9}, 
   3.540754445195182*^9, 3.540760265692865*^9, 3.540824284548471*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Replace", "[", 
  RowBox[{
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
     SubscriptBox["P", "n"]}], " ", 
    SubscriptBox["\[Epsilon]", "0"], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "m"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n1"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n2"}]], " ", 
    SubscriptBox["c", 
     RowBox[{"n1", ",", "n2", ",", "n3"}]]}], ",", "deletezero", ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.540737499253355*^9, 3.540737520909079*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.5407375227851057`*^9, 3.540748836507934*^9, 3.540749714197797*^9, 
   3.540750487835699*^9, 3.5407506998139353`*^9, 3.5407515537073107`*^9, 
   3.540752275876774*^9, {3.5407523331225986`*^9, 3.540752358688278*^9}, 
   3.54075444524522*^9, 3.540760265742894*^9, 3.54082428459873*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Replace", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"4", " ", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      SubscriptBox["P", "n"]}], " ", 
     SubscriptBox["\[Epsilon]", "0"], " ", 
     SubscriptBox["\[Delta]", 
      RowBox[{"n", ",", "m"}]], " ", 
     SubscriptBox["\[Delta]", 
      RowBox[{"n", ",", "n1"}]], " ", 
     SubscriptBox["\[Delta]", 
      RowBox[{"n", ",", "n2"}]], " ", 
     SubscriptBox["c", 
      RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
     SubscriptBox["P", "n"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
     SubscriptBox["P", "m"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}]}], ",", "deletezero", 
   ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.540738241078477*^9, 3.54073825259484*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
   SubscriptBox["P", "m"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540738255972726*^9, 3.540748836559128*^9, 3.540749714248166*^9, 
   3.540750487885456*^9, 3.5407506998642387`*^9, 3.540751553758377*^9, 
   3.540752275946213*^9, {3.540752333288842*^9, 3.540752358838256*^9}, 
   3.54075444529608*^9, 3.540760265793261*^9, 3.540824284649123*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell["\<\
Base on the above, deletezero can only be applied to a single term, where \
this single term can only have mutlitplication and noncomutative \
multiplications.\
\>", "Text",
 CellChangeTimes->{{3.540738268099416*^9, 3.540738335650325*^9}},
 Background->GrayLevel[0.85]],

Cell["Let's use a module to do the above", "Text",
 CellChangeTimes->{{3.540737588289441*^9, 3.540737608434849*^9}, {
  3.5407522671613293`*^9, 3.540752268006338*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{"deleteZeroTerm", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "xlist", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xlist", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"List", ",", "x"}], "]"}]}], " ", ";", 
     RowBox[{"(*", 
      RowBox[{
      "divide", " ", "a", " ", "single", " ", "term", " ", "into", " ", "a", 
       " ", "list"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"xlist", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"xlist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "deletezero", ",", "1"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "xlist", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Plus", ",", "xlist"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.540737617882132*^9, 3.540737661262899*^9}, {
   3.54073835027188*^9, 3.540738525568573*^9}, 3.540738593492634*^9, {
   3.540738674162734*^9, 3.54073868689355*^9}, {3.540738766645013*^9, 
   3.5407387760972023`*^9}},
 Background->GrayLevel[0.85]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"deleteZeroTerm", "[", 
  RowBox[{
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
     SubscriptBox["P", "n"]}], " ", 
    SubscriptBox["\[Epsilon]", "0"], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "m"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n1"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n2"}]], " ", 
    SubscriptBox["c", 
     RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.540738531316259*^9, 3.540738546751601*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
  SubscriptBox["P", "n"], "**", 
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
  SubscriptBox["P", "m"], "**", 
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}]], "Output",
 CellChangeTimes->{
  3.54073869213437*^9, 3.54073878169352*^9, 3.540748836639244*^9, 
   3.5407497143286753`*^9, 3.5407504880660057`*^9, 3.540750700013143*^9, 
   3.540751553838319*^9, 3.540752276043075*^9, {3.540752333370174*^9, 
   3.540752358919138*^9}, 3.540754445459038*^9, 3.540760265924613*^9, 
   3.54082428473002*^9},
 Background->GrayLevel[0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Schrodinger equation takinng into account of kinematic interaction\
\>", "Subtitle",
 CellChangeTimes->{{3.540575547537228*^9, 3.540575566165764*^9}},
 Background->RGBColor[1, 1, 0]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"multiply", " ", "two", " ", "terms"}], ",", " ", 
    RowBox[{
    "each", " ", "term", " ", "may", " ", "contain", " ", "both", " ", 
     "Times", " ", "and", " ", "NonCommutativeMultiply"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"multiply", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"x", ",", 
        RowBox[{"NonCommutativeMultiply", "[", "_", "]"}]}], "]"}], "&&", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"y", ",", 
        RowBox[{"NonCommutativeMultiply", "[", "_", "]"}]}], "]"}]}], ",", 
     " ", 
     RowBox[{"x", "**", "y"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"x", ",", 
        RowBox[{"Times", "[", "_", "]"}]}], "]"}], "&&", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"y", ",", 
        RowBox[{"NonCommutativeMultiply", "[", "_", "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"x", "**", "y"}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"Times", "[", 
         RowBox[{"u__", ",", 
          RowBox[{"NonCommutativeMultiply", "[", "v_", "]"}]}], "]"}], "**", 
        RowBox[{"NonCommutativeMultiply", "[", "w_", "]"}]}], "\[Rule]", 
       RowBox[{"Times", "[", 
        RowBox[{"u", ",", 
         RowBox[{"NonCommutativeMultiply", "[", 
          RowBox[{"v", ",", "w"}], "]"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"x", ",", 
        RowBox[{"Times", "[", "_", "]"}]}], "]"}], "&&", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"y", ",", 
        RowBox[{"Times", "[", "_", "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"x", "**", "y"}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"Times", "[", 
         RowBox[{"u__", ",", 
          RowBox[{"NonCommutativeMultiply", "[", "v_", "]"}]}], "]"}], "**", 
        RowBox[{"Times", "[", 
         RowBox[{"q__", ",", 
          RowBox[{"NonCommutativeMultiply", "[", "w_", "]"}]}], "]"}]}], 
       "\[Rule]", " ", 
       RowBox[{"Times", "[", 
        RowBox[{"u", ",", "q", ",", 
         RowBox[{"NonCommutativeMultiply", "[", 
          RowBox[{"v", ",", "w"}], "]"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellFrame->True,
 CellChangeTimes->{{3.540582254321753*^9, 3.5405822679609413`*^9}, {
  3.540582302282631*^9, 3.540582303866438*^9}, {3.540582532783291*^9, 
  3.540582554123294*^9}, {3.540582671796081*^9, 3.540582674527437*^9}, {
  3.5405827157938633`*^9, 3.540582831160697*^9}, {3.5405828637584963`*^9, 
  3.540583039248221*^9}, {3.540583124822954*^9, 3.540583134067368*^9}, {
  3.540583219968808*^9, 3.5405833115129843`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "define", " ", "operators", " ", "for", " ", "the", " ", "convenience", 
    " ", "of", " ", "writing"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Pdag", "[", "x_", "]"}], ":=", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "x"]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P", "[", "x_", "]"}], ":=", 
     SubscriptBox["P", "x"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    SubscriptBox["\[Delta]", 
     RowBox[{"x", ",", "y"}]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"n1_", ",", "n2_", ",", "n3_"}], "]"}], ":=", 
    SubscriptBox["c", 
     RowBox[{"n1", ",", "n2", ",", "n3"}]]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellFrame->True,
 CellChangeTimes->{{3.540575734764874*^9, 3.54057586694466*^9}, {
   3.540575922540862*^9, 3.540575934828478*^9}, {3.540576037233098*^9, 
   3.5405760603390408`*^9}, 3.540576226217231*^9, {3.540577482143758*^9, 
   3.540577514446024*^9}, {3.540587142802548*^9, 3.540587151859906*^9}, 
   3.601952402677086*^9}],

Cell["\<\
The commutation relation between two operators can be written as\
\>", "Text",
 CellChangeTimes->{{3.5405759438192997`*^9, 3.540575964139195*^9}, 
   3.540576232629322*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"commutationRule", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"P", "[", "a_", "]"}], "**", 
     RowBox[{"Pdag", "[", "b_", "]"}]}], "\[Rule]", " ", 
    RowBox[{
     RowBox[{"delta", "[", 
      RowBox[{"a", ",", "b"}], "]"}], "+", 
     RowBox[{
      RowBox[{"Pdag", "[", "b", "]"}], "**", 
      RowBox[{"P", "[", "a", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "2"}], ")"}], "**", 
      RowBox[{"delta", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "**", 
      RowBox[{"Pdag", "[", "a", "]"}], "**", 
      RowBox[{"P", "[", "a", "]"}]}]}]}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"writing", " ", "in", " ", "terms", " ", "of", " ", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], " ", "will", " ", "save", " ", "us", " ", 
    "some", " ", "trouble"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "it", " ", "is", " ", "better", " ", "to", " ", "regard", " ", "all", " ", 
    "multiplication", " ", "as", " ", "noncommutative"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5405759785435133`*^9, 3.540576027599698*^9}, {
  3.540576065968145*^9, 3.540576070241323*^9}, {3.540576109963863*^9, 
  3.5405761612291613`*^9}, {3.540576197353557*^9, 3.540576205439682*^9}, {
  3.540583989190353*^9, 3.540583994324285*^9}, {3.540734320231883*^9, 
  3.54073432546102*^9}, {3.540734578288258*^9, 3.540734585637875*^9}, {
  3.540734759342237*^9, 3.540734816182783*^9}, {3.540734861702825*^9, 
  3.540734912037455*^9}, {3.540758501599181*^9, 3.540758530058037*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["P", "a_"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "b_"]}], "\[Rule]", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "b"], "**", 
    SubscriptBox["P", "a"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"a", ",", "b"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "a"], "**", 
    SubscriptBox["P", "a"]}], "+", 
   SubscriptBox["\[Delta]", 
    RowBox[{"a", ",", "b"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540576164525919*^9, 3.540576210955969*^9, 3.540579253482307*^9, 
   3.540579834882654*^9, 3.540580274456469*^9, 3.540580599325226*^9, 
   3.54058337486672*^9, 3.540583997651812*^9, 3.540587160472962*^9, 
   3.5405872712583313`*^9, 3.540587406171019*^9, 3.540587476874617*^9, {
   3.5406664773077793`*^9, 3.5406664856491117`*^9}, 3.540667511724423*^9, 
   3.5406744264676943`*^9, 3.540732056669518*^9, 3.5407343350879602`*^9, 
   3.540734588914296*^9, 3.540734918726267*^9, 3.540748835036976*^9, 
   3.54074971255891*^9, 3.540750486011541*^9, 3.540750698074504*^9, 
   3.540751552102291*^9, 3.540752276191424*^9, {3.540752333503998*^9, 
   3.540752359052786*^9}, 3.540754445575748*^9, 3.540760266058264*^9, 
   3.54082428488206*^9}]
}, Open  ]],

Cell["the Hamiltonian including the dynamical interaction is", "Text",
 CellChangeTimes->{{3.540575650532529*^9, 3.540575691938053*^9}, {
  3.540576891957426*^9, 3.540576955676367*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ham", "=", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Epsilon]", "0"], 
      RowBox[{
       RowBox[{"Pdag", "[", "n", "]"}], "**", 
       RowBox[{"P", "[", "n", "]"}]}]}], ",", "n"}], "]"}], " ", "+", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["jex", 
         RowBox[{"n", ",", "m"}]], 
        RowBox[{
         RowBox[{"Pdag", "[", "n", "]"}], "**", 
         RowBox[{"P", "[", "m", "]"}]}]}], ",", "n"}], "]"}], ",", "m"}], 
    "]"}], "+", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["dyn", 
          RowBox[{"n", ",", "m"}]], 
         RowBox[{
          RowBox[{"Pdag", "[", "n", "]"}], "**", 
          RowBox[{"P", "[", "n", "]"}], "**", 
          RowBox[{"Pdag", "[", "m", "]"}], "**", 
          RowBox[{"P", "[", "m", "]"}]}]}], ",", "n"}], "]"}], ",", "m"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.540576412871315*^9, 3.5405764143704033`*^9}, {
  3.540576509678303*^9, 3.540576511310178*^9}, {3.540576634037177*^9, 
  3.540576637874256*^9}, {3.540576965541605*^9, 3.540577165272756*^9}, {
  3.5405771994903727`*^9, 3.5405772127919617`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   UnderscriptBox["\[Sum]", "n"], 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
     SubscriptBox["P", "n"]}], " ", 
    SubscriptBox["\[Epsilon]", "0"]}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    UnderscriptBox["\[Sum]", "m"], 
    RowBox[{"(", 
     RowBox[{
      UnderscriptBox["\[Sum]", "n"], 
      RowBox[{
       RowBox[{
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
        SubscriptBox["P", "n"], "**", 
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
        SubscriptBox["P", "m"]}], " ", 
       SubscriptBox["dyn", 
        RowBox[{"n", ",", "m"}]]}]}], ")"}]}]}], "+", 
  RowBox[{
   UnderscriptBox["\[Sum]", "m"], 
   RowBox[{"(", 
    RowBox[{
     UnderscriptBox["\[Sum]", "n"], 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
       SubscriptBox["P", "m"]}], " ", 
      SubscriptBox["jex", 
       RowBox[{"n", ",", "m"}]]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.540577218451543*^9, 3.540579256847076*^9, 3.5405798349849663`*^9, 
   3.540580274510427*^9, 3.540580602504415*^9, 3.540583374920437*^9, 
   3.540587160539974*^9, 3.540587271313014*^9, 3.540587406225374*^9, 
   3.540587476945035*^9, 3.540666486276469*^9, 3.5406675146686907`*^9, 
   3.540674431023492*^9, 3.540732063961678*^9, 3.540748835073839*^9, 
   3.5407497126123962`*^9, 3.540750486066533*^9, 3.540750698145076*^9, 
   3.5407515521550903`*^9, 3.540752276244776*^9, {3.540752333557214*^9, 
   3.5407523591060877`*^9}, 3.540754445631836*^9, 3.540760266110503*^9, 
   3.5408242853165483`*^9}]
}, Open  ]],

Cell["\<\
in order to simplify the derivation, we will ignore the summmation of n and \
m, then the hamiltonian can be written as \
\>", "Text",
 CellChangeTimes->{{3.5405772502546864`*^9, 3.540577297686007*^9}, {
  3.540750442621364*^9, 3.540750446643037*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ham", "=", 
  RowBox[{"(*", 
   RowBox[{"delta", "[", 
    RowBox[{"n", ",", "m"}], "]"}], "*)"}], 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Epsilon]", "0"], 
    RowBox[{
     RowBox[{"Pdag", "[", "n", "]"}], "**", 
     RowBox[{"P", "[", "n", "]"}]}]}], " ", "+", " ", 
   RowBox[{
    SubscriptBox["jex", 
     RowBox[{"n", ",", "m"}]], 
    RowBox[{
     RowBox[{"Pdag", "[", "n", "]"}], "**", 
     RowBox[{"P", "[", "m", "]"}]}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], 
    SubscriptBox["dyn", 
     RowBox[{"n", ",", "m"}]], 
    RowBox[{
     RowBox[{"Pdag", "[", "n", "]"}], "**", 
     RowBox[{"P", "[", "n", "]"}], "**", 
     RowBox[{"Pdag", "[", "m", "]"}], "**", 
     RowBox[{"P", "[", "m", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.540577303662087*^9, 3.5405773065595818`*^9}, {
   3.540577339691272*^9, 3.5405773808331327`*^9}, 3.540750429204486*^9, {
   3.540754402617495*^9, 3.540754433988357*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540577384525423*^9, 3.540579261253725*^9, 3.540579835084484*^9, 
   3.540580274560521*^9, 3.540580605464704*^9, 3.5405833749703074`*^9, 
   3.54058716062097*^9, 3.5405872713634253`*^9, 3.540587406275406*^9, 
   3.540587476995103*^9, 3.5406664863556013`*^9, 3.5406675179646072`*^9, 
   3.540674434020392*^9, 3.5407320687633133`*^9, 3.5407321879802303`*^9, 
   3.5407488351225357`*^9, 3.540749712662114*^9, 3.540750486133358*^9, 
   3.540750698194254*^9, 3.5407515522054462`*^9, 3.540752276295039*^9, {
   3.540752333606202*^9, 3.540752359156494*^9}, 3.540754445680987*^9, 
   3.540760266161127*^9, 3.5408242853553867`*^9}]
}, Open  ]],

Cell[TextData[{
 "Note that the term with ",
 Cell[BoxData[
  SubscriptBox["\[Epsilon]", "0"]],
  CellChangeTimes->{3.540577384525423*^9, 3.540579261253725*^9, 
   3.540579835084484*^9, 3.540580274560521*^9, 3.540580605464704*^9, 
   3.5405833749703074`*^9, 3.54058716062097*^9, 3.5405872713634253`*^9, 
   3.540587406275406*^9, 3.540587476995103*^9, 3.5406664863556013`*^9, 
   3.5406675179646072`*^9, 3.540674434020392*^9, 3.5407320687633133`*^9, 
   3.5407321879802303`*^9, 3.5407488351225357`*^9, 3.540749712662114*^9}],
 " is a single summation over n"
}], "Text",
 CellChangeTimes->{{3.54075045324618*^9, 3.540750475556118*^9}}],

Cell["\<\
The three-exciton state is given by (the vaccum state is ignored here)\
\>", "Text",
 CellChangeTimes->{{3.5405774517253*^9, 3.540577461547847*^9}, {
  3.5405777172940407`*^9, 3.540577729456828*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sum", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Sum", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "[", 
         RowBox[{"n1", ",", "n2", ",", "n3"}], "]"}], 
        RowBox[{
         RowBox[{"Pdag", "[", "n1", "]"}], "**", 
         RowBox[{"Pdag", "[", "n2", "]"}], "**", 
         RowBox[{"Pdag", "[", "n3", "]"}]}]}], ",", "n1"}], "]"}], ",", 
     "n2"}], "]"}], ",", "\[IndentingNewLine]", "n3"}], "]"}]], "Input",
 CellChangeTimes->{{3.540577602774453*^9, 3.540577699215681*^9}}],

Cell[BoxData[
 RowBox[{
  UnderscriptBox["\[Sum]", "n3"], 
  RowBox[{"(", 
   RowBox[{
    UnderscriptBox["\[Sum]", "n2"], 
    RowBox[{"(", 
     RowBox[{
      UnderscriptBox["\[Sum]", "n1"], 
      RowBox[{
       RowBox[{
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
       SubscriptBox["c", 
        RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}], ")"}]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.540577710182324*^9, 3.540579265592712*^9, 3.540579835151532*^9, 
   3.540580274608678*^9, 3.5405806085591784`*^9, 3.5405833750223*^9, 
   3.540587160706443*^9, 3.540587271413661*^9, 3.540587406325601*^9, 
   3.540587477044772*^9, 3.540666486439746*^9, 3.540667521143338*^9, 
   3.540674437368417*^9, 3.540732191699272*^9, 3.5407488351729593`*^9, 
   3.540749712729021*^9, 3.540750486198008*^9, 3.5407506982441998`*^9, 
   3.5407515522555323`*^9, 3.540752276345471*^9, {3.540752333673839*^9, 
   3.540752359206321*^9}, 3.540754445730357*^9, 3.5407602662107897`*^9, 
   3.540824285406179*^9}]
}, Open  ]],

Cell["\<\
For simplicity, we ignore the summations in the above three-exciton state and \
let the hamiltonian operate on it. (the coefficient c will be dropped for a \
moment)\
\>", "Text",
 CellChangeTimes->{{3.540577748385974*^9, 3.540577792654031*^9}, {
  3.5405794030780077`*^9, 3.540579431419551*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"threeExciton", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Pdag", "[", "n1", "]"}], "**", 
    RowBox[{"Pdag", "[", "n2", "]"}], "**", 
    RowBox[{"Pdag", "[", "n3", "]"}]}], 
   RowBox[{"c", "[", 
    RowBox[{"n1", ",", "n2", ",", "n3"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5405778223175573`*^9, 3.540577841828718*^9}, 
   3.540579441815961*^9, {3.540581013466419*^9, 3.5405810220020323`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
  SubscriptBox["c", 
   RowBox[{"n1", ",", "n2", ",", "n3"}]]}]], "Output",
 CellChangeTimes->{
  3.540577845076851*^9, 3.540579269714769*^9, 3.540579444427462*^9, 
   3.540579490283381*^9, 3.540579835218473*^9, 3.5405802746618843`*^9, 
   3.540580611790044*^9, 3.540580971696157*^9, 3.540581023726369*^9, 
   3.54058337507126*^9, 3.540587160773391*^9, 3.540587271463437*^9, 
   3.540587406392881*^9, 3.540587477095367*^9, 3.540666486623714*^9, 
   3.5406675243048162`*^9, 3.5406744407491913`*^9, 3.540732195398158*^9, 
   3.540748835223331*^9, 3.5407497127788143`*^9, 3.5407504862644043`*^9, 
   3.540750698295155*^9, 3.540751552304823*^9, 3.5407522763955107`*^9, {
   3.540752333741109*^9, 3.5407523592564173`*^9}, 3.540754445794231*^9, 
   3.540760266261479*^9, 3.5408242854587803`*^9}]
}, Open  ]],

Cell[TextData[{
 "In the following, the left-hand side is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"H", "|", "\[Psi]"}], "\[RightAngleBracket]"}], TraditionalForm]],
  
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.540583754865592*^9, 3.5405838023852663`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs", "=", 
  RowBox[{"Apply", "[", "\[IndentingNewLine]", 
   RowBox[{"Plus", ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"multiply", "[", 
       RowBox[{
        RowBox[{"ham", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
         ",", "threeExciton"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ham", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.540583432954507*^9, 3.540583525011516*^9}, {
  3.540583618769298*^9, 3.540583620726762*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.5405835301686907`*^9, 3.540583623900179*^9, 3.5405871608582563`*^9, 
   3.540587271515276*^9, 3.540587406444607*^9, 3.540587477147036*^9, 
   3.540666486710415*^9, 3.540667527368922*^9, 3.5406744438458853`*^9, 
   3.54073220086623*^9, 3.540734366277032*^9, 3.540734600724016*^9, 
   3.5407488352734337`*^9, 3.540749712846178*^9, 3.540750486330737*^9, 
   3.540750698346404*^9, 3.540751552372621*^9, 3.5407522764454803`*^9, {
   3.5407523338079576`*^9, 3.540752359307094*^9}, 3.5407544458607693`*^9, 
   3.540760266311479*^9, 3.5408242855078783`*^9}]
}, Open  ]],

Cell["\<\
Let's treate the first term separately (see \"Dealing with the first term in \
the hamiltonian\")\
\>", "Text",
 CellChangeTimes->{{3.540750626904944*^9, 3.5407506448174467`*^9}, {
  3.5407518157137613`*^9, 3.540751828686688*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs0", " ", "=", " ", 
  RowBox[{"First", "[", "lhs", "]"}]}]], "Input",
 CellChangeTimes->{{3.5405839579184*^9, 3.540583963456285*^9}, {
   3.5405840159564457`*^9, 3.540584018369596*^9}, {3.540750668551609*^9, 
   3.54075069266192*^9}, 3.54075179967349*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
   SubscriptBox["P", "n"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
  SubscriptBox["\[Epsilon]", "0"], " ", 
  SubscriptBox["c", 
   RowBox[{"n1", ",", "n2", ",", "n3"}]]}]], "Output",
 CellChangeTimes->{
  3.540752276496048*^9, {3.540752333874316*^9, 3.540752359356332*^9}, 
   3.5407544459609137`*^9, 3.5407602663616037`*^9, 3.540824285557699*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dealing with the first term in the hamiltonian", "Subtitle",
 CellChangeTimes->{{3.540751717384592*^9, 3.540751731148436*^9}},
 Background->RGBColor[1, 1, 0]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs01", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"lhs0", "//.", "commutationRule"}], "//.", "expand"}], "//", 
   "ExpandAll"}]}]], "Input",
 CellChangeTimes->{{3.5407507494053993`*^9, 3.540750764658064*^9}, {
  3.540751444128016*^9, 3.5407514481180973`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n1"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n1"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540750766943734*^9, 3.540750838499411*^9, 3.540751554742689*^9, 
   3.54075227660701*^9, {3.54075233395995*^9, 3.540752359407381*^9}, 
   3.5407544460459538`*^9, 3.5407602664118853`*^9, 3.540824285608459*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs02", "=", 
  RowBox[{"lhs01", "//.", "clean"}]}]], "Input",
 CellChangeTimes->{{3.540750781166973*^9, 3.540750783567067*^9}, 
   3.540750832291328*^9, {3.540751451957562*^9, 3.5407514583333797`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540750784610341*^9, 3.5407508415371847`*^9, 3.540751554793198*^9, 
   3.540752276666658*^9, {3.540752334011241*^9, 3.540752359437871*^9}, 
   3.540754446147169*^9, 3.540760266462131*^9, 3.540824285658856*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs03", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"lhs02", "//.", "commutationRule"}], "//.", "expand"}], "//", 
   "ExpandAll"}]}]], "Input",
 CellChangeTimes->{{3.540750847779964*^9, 3.540750855461225*^9}, {
  3.540751461878316*^9, 3.540751470910308*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n2"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n2"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n2"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n2"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540750857603938*^9, 3.5407515548444033`*^9, 3.5407522767255507`*^9, {
   3.540752334091301*^9, 3.540752359471589*^9}, 3.5407544462295218`*^9, 
   3.540760266512608*^9, 3.540824285710629*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs04", "=", 
  RowBox[{"lhs03", "//.", "clean"}]}]], "Input",
 CellChangeTimes->{{3.5407508630930357`*^9, 3.540750866713614*^9}, {
  3.540751477542564*^9, 3.540751485694405*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540750867890814*^9, 3.540751554877657*^9, 3.540752276783271*^9, {
   3.540752334146038*^9, 3.540752359505867*^9}, 3.540754446312141*^9, 
   3.540760266562448*^9, 3.540824285760911*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs05", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"lhs04", "//.", "commutationRule"}], "//.", "expand"}], "//", 
   "ExpandAll"}]}]], "Input",
 CellChangeTimes->{{3.540751490375313*^9, 3.540751498199201*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n3"}]]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n3"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n3"}]]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n3"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n3"}]]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n3"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n3"}]]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n3"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540750890323696*^9, 3.540751554912601*^9, 3.540752276928417*^9, {
   3.540752334304448*^9, 3.54075235954287*^9}, 3.540754446465806*^9, 
   3.540760266615138*^9, 3.540824285861649*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs06", "=", 
  RowBox[{"lhs05", "//.", "clean"}]}]], "Input",
 CellChangeTimes->{{3.540750894104237*^9, 3.5407508985387087`*^9}, {
  3.540751503767048*^9, 3.540751513007141*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"8", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540750900094976*^9, 3.540751554962781*^9, 3.540752276984955*^9, {
   3.540752334362362*^9, 3.540752359575468*^9}, 3.540754446567383*^9, 
   3.540760266664592*^9, 3.540824285896796*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs07", "=", 
  RowBox[{"deleteZeroTerm", "[", "lhs06", "]"}]}]], "Input",
 CellChangeTimes->{{3.540750913575273*^9, 3.540750921499569*^9}, {
  3.540751518536009*^9, 3.540751527951622*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540750923749813*^9, 3.540751555010758*^9, 3.540752277030118*^9, {
   3.540752334408465*^9, 3.5407523596058683`*^9}, 3.5407544466492367`*^9, 
   3.5407602667154417`*^9, 3.540824285945263*^9}]
}, Open  ]],

Cell[TextData[{
 "The above term is within the summation over n, the term with two and three \
deltas will be zero because you cannot excite a molecule more than once (you \
will obtain ",
 Cell[BoxData[
  SubscriptBox["c", 
   RowBox[{"n1", ",", "n1", ",", "n3"}]]],
  CellChangeTimes->{3.540750923749813*^9}],
 ", ",
 Cell[BoxData[
  SubscriptBox["c", 
   RowBox[{"n1", ",", "n2", ",", "n2"}]]],
  CellChangeTimes->{3.540750923749813*^9}],
 ", ... etc, which doesn't exist)"
}], "Text",
 CellChangeTimes->{{3.540751077089731*^9, 3.54075109357576*^9}, {
  3.540751155450095*^9, 3.5407511992992353`*^9}, {3.5407512395246077`*^9, 
  3.540751246492763*^9}, {3.540751282541902*^9, 3.54075133535231*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs08", "=", 
  RowBox[{"lhs07", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", 
        RowBox[{"n_", ",", "n1_"}]], " ", 
       SubscriptBox["\[Delta]", 
        RowBox[{"n_", ",", "n3_"}]]}], "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", 
        RowBox[{"n_", ",", "n1_"}]], " ", 
       SubscriptBox["\[Delta]", 
        RowBox[{"n_", ",", "n2_"}]], " ", 
       SubscriptBox["\[Delta]", 
        RowBox[{"n_", ",", "n3_"}]]}], "\[Rule]", "0"}]}], "}"}]}]}]], "Input",\

 CellChangeTimes->{{3.540751340858663*^9, 3.540751421246224*^9}, {
  3.540751533730257*^9, 3.540751543498664*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["\[Epsilon]", "0"], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{{3.5407514121025352`*^9, 3.5407514249100924`*^9}, 
   3.540751555127364*^9, 3.5407522770802917`*^9, {3.540752334458172*^9, 
   3.540752359657279*^9}, 3.540754446748897*^9, 3.54076026676199*^9, 
   3.5408242859783163`*^9}]
}, Open  ]],

Cell["\<\
Put the above term into the summation over n, they are the same, and the \
total results becomes:\
\>", "Text",
 CellChangeTimes->{{3.540751588738242*^9, 3.540751623113357*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs09", "=", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", "3", 
   SubscriptBox["\[Epsilon]", "0"], "  ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Input",
 CellChangeTimes->{{3.540751640140647*^9, 3.540751671158225*^9}}],

Cell[BoxData[
 RowBox[{"3", " ", 
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
  SubscriptBox["\[Epsilon]", "0"], " ", 
  SubscriptBox["c", 
   RowBox[{"n1", ",", "n2", ",", "n3"}]]}]], "Output",
 CellChangeTimes->{
  3.540751678581477*^9, 3.540752277130275*^9, {3.54075233450876*^9, 
   3.540752359706894*^9}, 3.540754446846792*^9, 3.540760266796026*^9, 
   3.5408242860117273`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5407518447724857`*^9, 3.540751845041457*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dealing with the rest terms in the hamiltonian", "Subtitle",
 CellChangeTimes->{{3.540751717384592*^9, 3.540751731148436*^9}, {
  3.5407518362513533`*^9, 3.540751840376625*^9}},
 Background->RGBColor[1, 1, 0]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs2", "=", 
  RowBox[{
   RowBox[{"Rest", "[", "lhs", "]"}], "/.", "commutationRule"}]}]], "Input",
 CellChangeTimes->{{3.5405839579184*^9, 3.540583963456285*^9}, {
   3.5405840159564457`*^9, 3.540584018369596*^9}, {3.540750668551609*^9, 
   3.54075069266192*^9}, 3.54075179967349*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
       SubscriptBox["P", "n"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}], "**", 
       SubscriptBox["\[Delta]", 
        RowBox[{"n", ",", "m"}]], "**", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
       SubscriptBox["P", "n"]}], "+", 
      SubscriptBox["\[Delta]", 
       RowBox[{"n", ",", "m"}]]}], ")"}], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
       SubscriptBox["P", "m"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}], "**", 
       SubscriptBox["\[Delta]", 
        RowBox[{"m", ",", "n1"}]], "**", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
       SubscriptBox["P", "m"]}], "+", 
      SubscriptBox["\[Delta]", 
       RowBox[{"m", ",", "n1"}]]}], ")"}], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540583968061803*^9, {3.5405840044473047`*^9, 3.540584021220175*^9}, 
   3.5405871609422073`*^9, 3.540587271565922*^9, 3.540587406495742*^9, 
   3.540587477198289*^9, 3.54066648681031*^9, 3.5406671414410152`*^9, 
   3.540667531036695*^9, 3.540674447799762*^9, 3.5407322225515213`*^9, 
   3.540734370634613*^9, 3.540734606933813*^9, 3.5407349496140327`*^9, 
   3.5407488353242188`*^9, 3.540749712913869*^9, 3.5407504863972607`*^9, 
   3.540750698396332*^9, 3.540751552422476*^9, 3.5407522772110863`*^9, {
   3.5407523345893707`*^9, 3.540752359888134*^9}, 3.540754446945621*^9, 
   3.540760266859725*^9, 3.5408242860788183`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs3", "=", 
  RowBox[{"lhs2", "//.", "expand"}]}]], "Input",
 CellChangeTimes->{{3.540732281624865*^9, 3.54073229591194*^9}, {
   3.540732328739745*^9, 3.540732475512146*^9}, {3.540732602076124*^9, 
   3.540732605237619*^9}, 3.540733007027692*^9, {3.540733037484748*^9, 
   3.540733041522078*^9}, {3.540733085558052*^9, 3.5407331557355347`*^9}, {
   3.5407332318367863`*^9, 3.5407332977653227`*^9}, {3.540734986605194*^9, 
   3.540734988588254*^9}, {3.540735225491878*^9, 3.540735226423089*^9}, 
   3.540735822068808*^9, {3.540736177208499*^9, 3.540736179813862*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      SubscriptBox["\[Delta]", 
       RowBox[{"n", ",", "m"}]], "**", 
      SubscriptBox["P", "m"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
      SubscriptBox["P", "n"], "**", 
      SubscriptBox["P", "m"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      RowBox[{"(", 
       RowBox[{"-", "2"}], ")"}], "**", 
      SubscriptBox["\[Delta]", 
       RowBox[{"n", ",", "m"}]], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      SubscriptBox["P", "n"], "**", 
      SubscriptBox["P", "m"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}]}], ")"}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      SubscriptBox["\[Delta]", 
       RowBox[{"m", ",", "n1"}]], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
      SubscriptBox["P", "m"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], "+", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      RowBox[{"(", 
       RowBox[{"-", "2"}], ")"}], "**", 
      SubscriptBox["\[Delta]", 
       RowBox[{"m", ",", "n1"}]], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
      SubscriptBox["P", "m"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}]}], ")"}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.5407322983500557`*^9, 3.540732330683539*^9, 3.540732476764216*^9, 
   3.540732607975008*^9, 3.540733010155753*^9, {3.540733077594516*^9, 
   3.540733088663169*^9}, 3.540733303293798*^9, 3.540734441048666*^9, 
   3.540734630466115*^9, 3.5407349963124657`*^9, 3.540735232035008*^9, 
   3.540735380325542*^9, 3.540735824741501*^9, 3.540736182886195*^9, 
   3.5407488356092873`*^9, 3.540749713248247*^9, 3.540750486767784*^9, 
   3.540750698763266*^9, 3.5407515528069344`*^9, 3.540752277247796*^9, {
   3.540752334646953*^9, 3.540752359941771*^9}, 3.540754446999482*^9, 
   3.540760266960788*^9, 3.540824286113555*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs4", "=", 
  RowBox[{"ExpandAll", "[", "lhs3", "]"}]}]], "Input",
 CellChangeTimes->{{3.540734662090584*^9, 3.540734667916771*^9}, {
  3.540735041763254*^9, 3.540735044008852*^9}, {3.540735086803812*^9, 
  3.540735088554472*^9}, {3.540736187600669*^9, 3.5407361967744293`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "m"}]], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "m"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n1"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n1"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540734670771319*^9, {3.540735020350123*^9, 3.54073504740303*^9}, 
   3.540735091085451*^9, 3.540735832630862*^9, 3.540736199535851*^9, 
   3.540748835642688*^9, 3.540749713298855*^9, 3.5407504868185263`*^9, 
   3.5407506988135023`*^9, 3.540751552857683*^9, 3.540752277304523*^9, {
   3.5407523347166452`*^9, 3.5407523599730043`*^9}, 3.54075444705007*^9, 
   3.540760266997171*^9, 3.540824286148458*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs5", "=", 
  RowBox[{"lhs4", "//.", "clean"}]}]], "Input",
 CellChangeTimes->{{3.5407326127016487`*^9, 3.5407326168340816`*^9}, {
   3.540735099301342*^9, 3.540735099594762*^9}, 3.540735137822365*^9, {
   3.54073622298573*^9, 3.540736229551599*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540732617698442*^9, 3.5407329378047867`*^9, 3.540735102274784*^9, 
   3.54073514169048*^9, 3.540736232136343*^9, 3.540748836107277*^9, 
   3.540749713780443*^9, 3.540750487349271*^9, 3.540750699327503*^9, 
   3.5407515532893467`*^9, 3.540752277381302*^9, {3.540752334809898*^9, 
   3.540752360024205*^9}, 3.5407544471001043`*^9, 3.5407602670467453`*^9, 
   3.5408242861822767`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs6", "=", 
  RowBox[{"lhs5", "//.", "commutationRule"}]}]], "Input",
 CellChangeTimes->{{3.540736254540413*^9, 3.5407362719415083`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
       SubscriptBox["P", "m"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}], "**", 
       SubscriptBox["\[Delta]", 
        RowBox[{"m", ",", "n1"}]], "**", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
       SubscriptBox["P", "m"]}], "+", 
      SubscriptBox["\[Delta]", 
       RowBox[{"m", ",", "n1"}]]}], ")"}], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
       SubscriptBox["P", "m"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}], "**", 
       SubscriptBox["\[Delta]", 
        RowBox[{"m", ",", "n2"}]], "**", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
       SubscriptBox["P", "m"]}], "+", 
      SubscriptBox["\[Delta]", 
       RowBox[{"m", ",", "n2"}]]}], ")"}], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
       SubscriptBox["P", "m"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}], "**", 
       SubscriptBox["\[Delta]", 
        RowBox[{"m", ",", "n2"}]], "**", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
       SubscriptBox["P", "m"]}], "+", 
      SubscriptBox["\[Delta]", 
       RowBox[{"m", ",", "n2"}]]}], ")"}], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
       SubscriptBox["P", "m"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}], "**", 
       SubscriptBox["\[Delta]", 
        RowBox[{"m", ",", "n1"}]], "**", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
       SubscriptBox["P", "m"]}], "+", 
      SubscriptBox["\[Delta]", 
       RowBox[{"m", ",", "n1"}]]}], ")"}], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
       SubscriptBox["P", "m"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}], "**", 
       SubscriptBox["\[Delta]", 
        RowBox[{"m", ",", "n1"}]], "**", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
       SubscriptBox["P", "m"]}], "+", 
      SubscriptBox["\[Delta]", 
       RowBox[{"m", ",", "n1"}]]}], ")"}], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540736274416644*^9, 3.540748836144211*^9, 3.540749713817341*^9, 
   3.540750487403399*^9, 3.540750699380948*^9, 3.540751553326859*^9, 
   3.540752277438895*^9, {3.540752334867104*^9, 3.540752360057288*^9}, 
   3.540754447167677*^9, 3.540760267082377*^9, 3.540824286215822*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs7", "=", 
  RowBox[{"ExpandAll", "[", 
   RowBox[{"lhs6", "//.", "expand"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.540736281321319*^9, 3.540736311474338*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n1"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n1"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n2"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n2"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n2"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n2"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n1"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n1"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n1"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], "**", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n1"}]], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{{3.5407362930913343`*^9, 3.5407363128685417`*^9}, 
   3.540748836197008*^9, 3.540749713869837*^9, 3.540750487472989*^9, 
   3.540750699433508*^9, 3.5407515533773823`*^9, 3.540752277512103*^9, {
   3.54075233493983*^9, 3.540752360092559*^9}, 3.540754447236619*^9, 
   3.540760267133264*^9, 3.5408242862512074`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs8", "=", 
  RowBox[{"lhs7", "//.", "clean"}]}]], "Input",
 CellChangeTimes->{{3.5407363342093897`*^9, 3.5407363460830927`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.5407363471013327`*^9, 3.540748836263687*^9, 3.5407497139370613`*^9, 
   3.540750487539906*^9, 3.540750699500394*^9, 3.5407515534441977`*^9, 
   3.540752277568947*^9, {3.540752334997078*^9, 3.5407523601413393`*^9}, 
   3.5407544473033857`*^9, 3.540760267183704*^9, 3.5408242863014727`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"lhs9", "=", 
   RowBox[{"deleteZeroTerm", "[", "lhs8", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.540667134694686*^9, 3.540667137154016*^9}, {
  3.5407365332432423`*^9, 3.540736586994961*^9}, {3.5407375469204073`*^9, 
  3.5407375616030493`*^9}, {3.5407376733692713`*^9, 3.54073768328671*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{{3.540736556769044*^9, 3.540736573961892*^9}, 
   3.540737563313959*^9, 3.540737685140081*^9, 3.540748836697472*^9, 
   3.54074971438945*^9, 3.5407504881239977`*^9, 3.5407507000847387`*^9, 
   3.540751553897723*^9, 3.540752277645833*^9, {3.540752335090393*^9, 
   3.540752360208438*^9}, 3.540754447369416*^9, 3.540760267267208*^9, 
   3.540824286351801*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"lhs10", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"lhs9", "//.", "commutationRule"}], "//.", "expand"}], "//", 
    "ExpandAll"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.540737804664852*^9, 3.540737978056727*^9}, {
   3.540738017892663*^9, 3.540738033722547*^9}, 3.540738065732306*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs11", "=", 
  RowBox[{"lhs10", "//.", "clean"}]}]], "Input",
 CellChangeTimes->{{3.540737804664852*^9, 3.540737978056727*^9}, {
  3.540738017892663*^9, 3.540738033722547*^9}, {3.540738065732306*^9, 
  3.540738082020389*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"], "**", 
    SubscriptBox["P", "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"], "**", 
    SubscriptBox["P", "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"], "**", 
    SubscriptBox["P", "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"], "**", 
    SubscriptBox["P", "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"8", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubsuperscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}], "2"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubsuperscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}], "2"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubsuperscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}], "2"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubsuperscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}], "2"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubsuperscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}], "2"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"8", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubsuperscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}], "2"], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540738089274952*^9, 3.5407488370219507`*^9, 3.540749714858294*^9, 
   3.540750488451458*^9, 3.540750700367937*^9, 3.540751554217808*^9, 
   3.540752277755722*^9, {3.5407523352145452`*^9, 3.540752360497076*^9}, 
   3.540754447784883*^9, 3.540760267556183*^9, 3.540824286632674*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lhs12", "=", 
   RowBox[{
    RowBox[{"deleteZeroTerm", "[", "lhs11", "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", 
        RowBox[{"n", ",", "m"}]], "\[Rule]", "0"}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Delta]", 
        RowBox[{"m", ",", "n"}]], "\[Rule]", "0"}]}], "}"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "We", " ", "want", " ", "to", " ", "get", " ", "rid", " ", "of", " ", 
    "the", " ", "terms", " ", "that", " ", "contain", " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n"}]], " ", "and", " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "m"}]], " ", "because", " ", "they", " ", "will", " ", 
    "make", " ", 
    SubscriptBox["dyn", 
     RowBox[{"n", ",", "m"}]], " ", "and", " ", 
    SubscriptBox["jex", 
     RowBox[{"n", ",", "m"}]], " ", "becomes", " ", 
    SubscriptBox["dyn", 
     RowBox[{"n", ",", "n"}]], " ", "and", " ", 
    SubscriptBox["jex", 
     RowBox[{"n", ",", "n"}]], " ", "which", " ", "are", " ", 
    RowBox[{"zero", ".", " ", "Note"}], " ", "all", " ", "terms", " ", "will",
     " ", "appear", " ", "within", " ", "the", " ", "summation", " ", "over", 
    " ", "n", " ", "and", " ", 
    RowBox[{"m", "."}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.540737804664852*^9, 3.540737978056727*^9}, {
  3.540738017892663*^9, 3.540738033722547*^9}, {3.540738065732306*^9, 
  3.540738082020389*^9}, {3.540749591379546*^9, 3.540749593355461*^9}, {
  3.6019524528449554`*^9, 3.6019526661251545`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox["P", "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox["P", "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.540737864738831*^9, {3.540737898558525*^9, 3.540737922814498*^9}, {
   3.540737954189294*^9, 3.540737979527422*^9}, 3.540738036502429*^9, 
   3.540748837160572*^9, 3.540749595420372*^9, 3.540749714937476*^9, 
   3.54075048854283*^9, 3.5407507004537163`*^9, 3.540751554280567*^9, 
   3.540752277829302*^9, {3.540752335371616*^9, 3.540752360544488*^9}, 
   3.5407544478723583`*^9, 3.540760267618827*^9, 3.540824286689425*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lhs13", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"lhs12", "//.", "commutationRule"}], "//.", "expand"}], "//", 
    "ExpandAll"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"lhs14", "=", 
   RowBox[{"lhs13", "//.", "clean"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "lhs14", "]"}], "\[IndentingNewLine]", 
 RowBox[{"lhs15", "=", 
  RowBox[{
   RowBox[{"deleteZeroTerm", "[", "lhs14", "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", 
       RowBox[{"n", ",", "m"}]], "\[Rule]", "0"}], ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", 
       RowBox[{"m", ",", "n"}]], "\[Rule]", "0"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "lhs15", "]"}]}], "Input",
 CellChangeTimes->{{3.540737804664852*^9, 3.540737978056727*^9}, {
   3.540738017892663*^9, 3.540738033722547*^9}, 3.540738065732306*^9, {
   3.5407489807440147`*^9, 3.540748984461729*^9}, 3.540749117717236*^9, {
   3.540749605300379*^9, 3.540749606981226*^9}}],

Cell[BoxData["84"], "Output",
 CellChangeTimes->{{3.540749030282792*^9, 3.540749043154467*^9}, 
   3.5407490805119553`*^9, 3.540749121876892*^9, 3.540749609131744*^9, 
   3.540749715288715*^9, 3.5407504889138947`*^9, 3.540750700809579*^9, 
   3.5407515546382637`*^9, 3.540752277981098*^9, {3.540752335443418*^9, 
   3.5407523608989887`*^9}, 3.54075444822546*^9, 3.540760267978327*^9, 
   3.54082428704599*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{{3.540749030282792*^9, 3.540749043154467*^9}, 
   3.5407490805119553`*^9, 3.540749121876892*^9, 3.540749609131744*^9, 
   3.540749715288715*^9, 3.5407504889138947`*^9, 3.540750700809579*^9, 
   3.5407515546382637`*^9, 3.540752277981098*^9, {3.540752335443418*^9, 
   3.5407523608989887`*^9}, 3.54075444822546*^9, 3.540760267978327*^9, 
   3.5408242870541563`*^9}],

Cell[BoxData["19"], "Output",
 CellChangeTimes->{{3.540749030282792*^9, 3.540749043154467*^9}, 
   3.5407490805119553`*^9, 3.540749121876892*^9, 3.540749609131744*^9, 
   3.540749715288715*^9, 3.5407504889138947`*^9, 3.540750700809579*^9, 
   3.5407515546382637`*^9, 3.540752277981098*^9, {3.540752335443418*^9, 
   3.5407523608989887`*^9}, 3.54075444822546*^9, 3.540760267978327*^9, 
   3.540824287062611*^9}]
}, Open  ]],

Cell[TextData[{
 "Note that the terms which contain ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]]}]],
  CellChangeTimes->{{3.540749030282792*^9, 3.540749043154467*^9}, 
    3.5407490805119553`*^9, 3.540749121876892*^9, 3.540749609131744*^9, 
    3.540749715288715*^9, 3.5407504889138947`*^9, 3.540750700809579*^9, 
    3.5407515546382637`*^9, 3.540752277981098*^9, {3.540752335443418*^9, 
    3.5407523609278097`*^9}}],
 " and ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]]}]],
  CellChangeTimes->{{3.540749030282792*^9, 3.540749043154467*^9}, 
    3.5407490805119553`*^9, 3.540749121876892*^9, 3.540749609131744*^9, 
    3.540749715288715*^9, 3.5407504889138947`*^9, 3.540750700809579*^9, 
    3.5407515546382637`*^9, 3.540752277981098*^9, {3.540752335443418*^9, 
    3.5407523609278097`*^9}}],
 Cell[BoxData[
  SubscriptBox["\[Delta]", 
   RowBox[{"n", ",", "n3"}]]],
  CellChangeTimes->{{3.540749030282792*^9, 3.540749043154467*^9}, 
    3.5407490805119553`*^9, 3.540749121876892*^9, 3.540749609131744*^9, 
    3.540749715288715*^9, 3.5407504889138947`*^9, 3.540750700809579*^9, 
    3.5407515546382637`*^9, 3.540752277981098*^9, {3.540752335443418*^9, 
    3.5407523609278097`*^9}}],
 " will be zero"
}], "Text",
 CellChangeTimes->{{3.540753885684568*^9, 3.540753942931408*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs16", "=", 
  RowBox[{"lhs15", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", 
        RowBox[{"n", ",", "n2_"}]], " ", 
       SubscriptBox["\[Delta]", 
        RowBox[{"n", ",", "n3_"}]]}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", 
        RowBox[{"m", ",", "n2_"}]], " ", 
       SubscriptBox["\[Delta]", 
        RowBox[{"m", ",", "n3_"}]]}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", 
        RowBox[{"n", ",", "n1_"}]], 
       SubscriptBox["\[Delta]", 
        RowBox[{"n", ",", "n2_"}]], " ", 
       SubscriptBox["\[Delta]", 
        RowBox[{"n", ",", "n3_"}]]}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", 
        RowBox[{"m", ",", "n1_"}]], 
       SubscriptBox["\[Delta]", 
        RowBox[{"m", ",", "n2_"}]], " ", 
       SubscriptBox["\[Delta]", 
        RowBox[{"m", ",", "n3_"}]]}], "\[Rule]", "0"}]}], "}"}]}]}]], "Input",\

 CellChangeTimes->{{3.54075396330646*^9, 3.540754021938184*^9}, {
  3.540754063774001*^9, 3.5407541206945963`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["jex", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n1"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n3"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n2"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n1"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}], " ", 
   SubscriptBox["dyn", 
    RowBox[{"n", ",", "m"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"m", ",", "n2"}]], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"n", ",", "n3"}]], " ", 
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]], "Output",
 CellChangeTimes->{{3.540754105486487*^9, 3.540754124052291*^9}, 
   3.540754448319549*^9, 3.540760268180808*^9, 3.540824287188341*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"The", " ", "first", " ", "three", " ", "terms", " ", "are", " ", 
  "equivalent", " ", "to", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"exchanging", " ", "index", " ", "n1", " ", "and", " ", "n"}], 
    ",", " ", "..."}], ")"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"n1", ",", " ", "n2", ",", " ", "n3"}]], 
    RowBox[{
     SubscriptBox["\[Sum]", "m"], 
     RowBox[{
      SubscriptBox["\[Sum]", "n"], 
      RowBox[{
       RowBox[{
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
       SubscriptBox["jex", 
        RowBox[{"n", ",", "m"}]], " ", 
       SubscriptBox["\[Delta]", 
        RowBox[{"m", ",", "n1"}]], " ", 
       SubscriptBox["c", 
        RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]}]}], "+", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
    SubscriptBox["jex", 
     RowBox[{"n", ",", "m"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n2"}]], " ", 
    SubscriptBox["c", 
     RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
    SubscriptBox["jex", 
     RowBox[{"n", ",", "m"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n3"}]], " ", 
    SubscriptBox["c", 
     RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"n1", ",", " ", "n2", ",", " ", "n3"}]], 
     RowBox[{
      SubscriptBox["\[Sum]", "n"], 
      RowBox[{
       RowBox[{
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], "J", 
       RowBox[{"(", 
        RowBox[{"n", ",", " ", "n1"}], ")"}], 
       SubscriptBox["c", 
        RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]}], " ", "+", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], "J", 
     RowBox[{"(", 
      RowBox[{"n", ",", " ", "n2"}], ")"}], 
     SubscriptBox["c", 
      RowBox[{"n1", ",", "n2", ",", "n3"}]]}], "+", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", "J", 
     RowBox[{"(", 
      RowBox[{"n", ",", " ", "n3"}], ")"}], 
     SubscriptBox["c", 
      RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"n1", ",", " ", "n2", ",", " ", "n3"}]], 
    RowBox[{
     SubscriptBox["\[Sum]", "n"], 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], "J", 
      RowBox[{"(", 
       RowBox[{"n", ",", " ", "n1"}], ")"}], 
      SubscriptBox["c", 
       RowBox[{"n", ",", " ", "n2", ",", " ", "n3"}]]}]}]}], " ", "+", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], "J", 
    RowBox[{"(", 
     RowBox[{"n", ",", " ", "n2"}], ")"}], 
    SubscriptBox["c", 
     RowBox[{"n1", ",", " ", "n", ",", " ", "n3"}]]}], "+", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", "J", 
    RowBox[{"(", 
     RowBox[{"n", ",", " ", "n3"}], ")"}], 
    SubscriptBox["c", 
     RowBox[{"n1", ",", " ", "n2", ",", " ", "n"}]]}]}]}], "\n", 
 RowBox[{
  RowBox[{
  "The", " ", "last", " ", "six", " ", "terms", " ", "are", " ", "equivalent",
    " ", "to"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   FormBox[
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"n1", ",", " ", "n2", ",", " ", "n3"}]], 
     RowBox[{
      SubscriptBox["\[Sum]", "m"], 
      RowBox[{
       SubscriptBox["\[Sum]", "n"], 
       RowBox[{
        RowBox[{
         SubscriptBox[
          RowBox[{"(", 
           SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
         SubscriptBox[
          RowBox[{"(", 
           SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
         SubscriptBox[
          RowBox[{"(", 
           SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}], " ", 
        SubscriptBox["dyn", 
         RowBox[{"n", ",", "m"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"m", ",", "n2"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"n", ",", "n1"}]], " ", 
        SubscriptBox["c", 
         RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}]}]}],
    TraditionalForm], " ", "+", "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n2"]}], " ", 
    SubscriptBox["dyn", 
     RowBox[{"n", ",", "m"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n3"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n1"}]], " ", 
    SubscriptBox["c", 
     RowBox[{"n1", ",", "n2", ",", "n3"}]]}], " ", "+", "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n1"]}], " ", 
    SubscriptBox["dyn", 
     RowBox[{"n", ",", "m"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"m", ",", "n3"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"n", ",", "n2"}]], " ", 
    SubscriptBox["c", 
     RowBox[{"n1", ",", "n2", ",", "n3"}]]}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FormBox[
     SubscriptBox["\[Sum]", 
      RowBox[{"n1", ",", " ", "n2", ",", " ", "n3"}]],
     TraditionalForm], 
    RowBox[{
     FormBox[
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}],
      TraditionalForm], " ", 
     RowBox[{
      FormBox[
       SubscriptBox["c", 
        RowBox[{"n1", ",", "n2", ",", "n3"}]],
       TraditionalForm], " ", "[", " ", 
      RowBox[{
       RowBox[{"D", 
        RowBox[{"(", 
         RowBox[{"n1", "-", "n2"}], ")"}]}], " ", "+", " ", 
       RowBox[{"D", 
        RowBox[{"(", 
         RowBox[{"n1", "-", "n3"}], ")"}]}], " ", "+", " ", 
       RowBox[{"D", 
        RowBox[{"(", 
         RowBox[{"n2", "-", "n3"}], ")"}]}]}], " ", "]"}]}]}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"Therefore", ",", " ", 
   RowBox[{
   "the", " ", "lhs16", " ", "term", " ", "is", " ", "equivalent", " ", 
    "to"}]}], " "}], "\n", 
 RowBox[{
  RowBox[{
   FormBox[
    SubscriptBox["\[Sum]", 
     RowBox[{"n1", ",", " ", "n2", ",", " ", "n3"}]],
    TraditionalForm], " ", 
   FormBox[
    RowBox[{
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}],
    TraditionalForm]}], " "}], "\n", 
 RowBox[{
  RowBox[{"\[Cross]", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{
      FormBox[
       SubscriptBox["c", 
        RowBox[{"n1", ",", "n2", ",", "n3"}]],
       TraditionalForm], "[", " ", 
      RowBox[{
       RowBox[{"D", 
        RowBox[{"(", 
         RowBox[{"n1", "-", "n2"}], ")"}]}], " ", "+", " ", 
       RowBox[{"D", 
        RowBox[{"(", 
         RowBox[{"n1", "-", "n3"}], ")"}]}], " ", "+", " ", 
       RowBox[{"D", 
        RowBox[{"(", 
         RowBox[{"n2", "-", "n3"}], ")"}]}]}], " ", "]"}], " ", "+", "\n", 
     RowBox[{
      FormBox[
       SubscriptBox["\[Sum]", "n"],
       TraditionalForm], 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"J", 
         RowBox[{"(", 
          RowBox[{"n", ",", " ", "n1"}], ")"}], 
         SubscriptBox["c", 
          RowBox[{"n", ",", " ", "n2", ",", " ", "n3"}]]}], " ", "+", " ", 
        RowBox[{"J", 
         RowBox[{"(", 
          RowBox[{"n", ",", " ", "n2"}], ")"}], 
         SubscriptBox["c", 
          RowBox[{"n1", ",", " ", "n", ",", " ", "n3"}]]}], " ", "+", " ", 
        RowBox[{"J", 
         RowBox[{"(", 
          RowBox[{"n", ",", " ", "n3"}], ")"}], 
         SubscriptBox["c", 
          RowBox[{"n1", ",", " ", "n2", ",", " ", "n"}]]}]}], "]"}]}]}], 
    "}"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"Adding", " ", "up", " ", "lhs0"}], ",", " ", 
  RowBox[{
   RowBox[{
   "we", " ", "can", " ", "obtan", " ", "the", " ", "whole", " ", "left"}], 
   "-", 
   RowBox[{
   "hand", " ", "side", " ", "of", " ", "the", " ", "Schroding", " ", 
    "equation"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   FormBox[
    SubscriptBox["\[Sum]", 
     RowBox[{"n1", ",", " ", "n2", ",", " ", "n3"}]],
    TraditionalForm], " ", 
   RowBox[{
    FormBox[
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}],
     TraditionalForm], " ", "\[Cross]", " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       FormBox[
        SubscriptBox["c", 
         RowBox[{"n1", ",", "n2", ",", "n3"}]],
        TraditionalForm], "[", " ", 
       RowBox[{
        RowBox[{"D", 
         RowBox[{"(", 
          RowBox[{"n1", "-", "n2"}], ")"}]}], " ", "+", " ", 
        RowBox[{"D", 
         RowBox[{"(", 
          RowBox[{"n1", "-", "n3"}], ")"}]}], " ", "+", " ", 
        RowBox[{"D", 
         RowBox[{"(", 
          RowBox[{"n2", "-", "n3"}], ")"}]}]}], " ", "]"}], " ", "+", " ", 
      RowBox[{
       FormBox[
        SubscriptBox["\[Sum]", "n"],
        TraditionalForm], 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"J", 
          RowBox[{"(", 
           RowBox[{"n", ",", " ", "n1"}], ")"}], 
          SubscriptBox["c", 
           RowBox[{"n", ",", " ", "n2", ",", " ", "n3"}]]}], " ", "+", " ", 
         RowBox[{"J", 
          RowBox[{"(", 
           RowBox[{"n", ",", " ", "n2"}], ")"}], 
          SubscriptBox["c", 
           RowBox[{"n1", ",", " ", "n", ",", " ", "n3"}]]}], " ", "+", "\n", 
         RowBox[{"J", 
          RowBox[{"(", 
           RowBox[{"n", ",", " ", "n3"}], ")"}], 
          SubscriptBox["c", 
           RowBox[{"n1", ",", " ", "n2", ",", " ", "n"}]]}]}], "]"}]}]}], 
     "}"}]}]}], " ", "+", " ", 
  RowBox[{
   FormBox[
    SubscriptBox["\[Sum]", 
     RowBox[{"n1", ",", " ", "n2", ",", " ", "n3"}]],
    TraditionalForm], " ", 
   RowBox[{
    FormBox[
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}],
     TraditionalForm], " ", 
    FormBox[
     RowBox[{"3", 
      SubscriptBox["\[Epsilon]", "0"]}],
     TraditionalForm], 
    FormBox[
     SubscriptBox["c", 
      RowBox[{"n1", ",", "n2", ",", "n3"}]],
     TraditionalForm]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FormBox[
     SubscriptBox["\[Sum]", 
      RowBox[{"n1", ",", " ", "n2", ",", " ", "n3"}]],
     TraditionalForm], " ", 
    RowBox[{
     FormBox[
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n"], "**", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "m"], "**", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["P", "\[Dagger]"], ")"}], "n3"]}],
      TraditionalForm], " ", "\[Epsilon]", 
     FormBox[
      RowBox[{" ", 
       SubscriptBox["c", 
        RowBox[{"n1", ",", "n2", ",", "n3"}]]}],
      TraditionalForm]}]}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"This", " ", "leads", " ", "to"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FormBox[
        RowBox[{"3", 
         SubscriptBox["\[Epsilon]", "0"]}],
        TraditionalForm], " ", "-", "  ", "\[Epsilon]"}], ")"}], " ", 
     FormBox[
      SubscriptBox["c", 
       RowBox[{"n1", ",", "n2", ",", "n3"}]],
      TraditionalForm]}], " ", "+", " ", 
    RowBox[{
     FormBox[
      SubscriptBox["\[Sum]", "n"],
      TraditionalForm], 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"J", 
        RowBox[{"(", 
         RowBox[{"n", ",", " ", "n1"}], ")"}], 
        SubscriptBox["c", 
         RowBox[{"n", ",", " ", "n2", ",", " ", "n3"}]]}], " ", "+", " ", 
       RowBox[{"J", 
        RowBox[{"(", 
         RowBox[{"n", "-", " ", "n2"}], ")"}], 
        SubscriptBox["c", 
         RowBox[{"n1", ",", " ", "n", ",", " ", "n3"}]]}], " ", "+", " ", 
       RowBox[{"J", 
        RowBox[{"(", 
         RowBox[{"n", "-", " ", "n3"}], ")"}], 
        SubscriptBox["c", 
         RowBox[{"n1", ",", " ", "n2", ",", " ", "n"}]]}]}], "]"}]}], " ", 
    "+", " ", 
    RowBox[{
     FormBox[
      SubscriptBox["c", 
       RowBox[{"n1", ",", "n2", ",", "n3"}]],
      TraditionalForm], "[", " ", 
     RowBox[{
      RowBox[{"D", 
       RowBox[{"(", 
        RowBox[{"n1", "-", "n2"}], ")"}]}], " ", "+", " ", 
      RowBox[{"D", 
       RowBox[{"(", 
        RowBox[{"n1", "-", "n3"}], ")"}]}], " ", "+", " ", 
      RowBox[{"D", 
       RowBox[{"(", 
        RowBox[{"n2", "-", "n3"}], ")"}]}]}], " ", "]"}]}], " ", "=", " ", 
   "0"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "The", " ", "above", " ", "equation", " ", "is", " ", "defined", " ", 
    "only", " ", "for", " ", "the", " ", "cases", " ", "where", " ", "n1"}], 
   " ", "\[NotEqual]", " ", "n2", " ", "\[NotEqual]", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"n3", ".", " ", "In"}], " ", "order", " ", "to", " ", "make", 
     " ", "the", " ", "left"}], " ", "-", " ", 
    RowBox[{
    "hand", " ", "side", " ", "of", " ", "it", " ", "equivalent", " ", "to", 
     " ", "the", " ", "case", " ", "of", " ", "three", " ", "noninteracting", 
     " ", "bosons"}]}]}], ",", " ", 
  RowBox[{
   RowBox[{
   "we", " ", "add", " ", "certain", " ", "terms", " ", "to", " ", "the", " ",
     "right"}], " ", "-", " ", 
   RowBox[{
   "hand", " ", "side", " ", "of", " ", "the", " ", "equation"}]}]}], "\n", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FormBox[
        RowBox[{"3", 
         SubscriptBox["\[Epsilon]", "0"]}],
        TraditionalForm], " ", "-", "  ", "\[Epsilon]"}], ")"}], " ", 
     FormBox[
      SubscriptBox["c", 
       RowBox[{"n1", ",", "n2", ",", "n3"}]],
      TraditionalForm]}], " ", "+", " ", 
    RowBox[{
     FormBox[
      SubscriptBox["\[Sum]", "n"],
      TraditionalForm], 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"J", 
        RowBox[{"(", 
         RowBox[{"n", "-", " ", "n1"}], ")"}], 
        SubscriptBox["c", 
         RowBox[{"n", ",", " ", "n2", ",", " ", "n3"}]]}], " ", "+", " ", 
       RowBox[{"J", 
        RowBox[{"(", 
         RowBox[{"n", "-", " ", "n2"}], ")"}], 
        SubscriptBox["c", 
         RowBox[{"n1", ",", " ", "n", ",", " ", "n3"}]]}], " ", "+", " ", 
       RowBox[{"J", 
        RowBox[{"(", 
         RowBox[{"n", ",", " ", "n3"}], ")"}], 
        SubscriptBox["c", 
         RowBox[{"n1", ",", " ", "n2", ",", " ", "n"}]]}]}], "]"}]}], " ", 
    "+", " ", 
    RowBox[{
     FormBox[
      SubscriptBox["c", 
       RowBox[{"n1", ",", "n2", ",", "n3"}]],
      TraditionalForm], "[", " ", 
     RowBox[{
      RowBox[{"D", 
       RowBox[{"(", 
        RowBox[{"n1", "-", "n2"}], ")"}]}], " ", "+", " ", 
      RowBox[{"D", 
       RowBox[{"(", 
        RowBox[{"n1", "-", "n3"}], ")"}]}], " ", "+", " ", 
      RowBox[{"D", 
       RowBox[{"(", 
        RowBox[{"n2", "-", "n3"}], ")"}]}]}], " ", "]"}]}], "DisplayFormula",
   FontColor->RGBColor[1, 0, 0]], 
  StyleBox["\[IndentingNewLine]", "DisplayFormula",
   FontColor->RGBColor[1, 0, 0]], 
  StyleBox[" ", "DisplayFormula",
   FontColor->RGBColor[1, 0, 0]], 
  StyleBox["\n", "DisplayFormula",
   FontColor->RGBColor[1, 0, 0]]}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"2", 
      SubscriptBox["\[Delta]", 
       RowBox[{"n1", ",", "n2"}]], 
      RowBox[{
       FormBox[
        SubscriptBox["\[Sum]", "n"],
        TraditionalForm], 
       RowBox[{"J", 
        RowBox[{"(", 
         RowBox[{"n1", "-", "n"}], ")"}], 
        SubscriptBox["c", 
         RowBox[{"n", ",", " ", "n2", ",", " ", "n3"}]]}]}]}], " ", "+", " ", 
     
     RowBox[{
      SubscriptBox[
       RowBox[{"2", "\[Delta]"}], 
       RowBox[{"n2", ",", "n3"}]], 
      RowBox[{
       FormBox[
        SubscriptBox["\[Sum]", "n"],
        TraditionalForm], 
       RowBox[{"J", 
        RowBox[{"(", 
         RowBox[{"n2", "-", "n"}], ")"}], 
        SubscriptBox["c", 
         RowBox[{"n1", ",", " ", "n", ",", " ", "n3"}]]}]}]}], " ", "+", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"2", 
      SubscriptBox["\[Delta]", 
       RowBox[{"n1", ",", "n3"}]], 
      RowBox[{
       FormBox[
        SubscriptBox["\[Sum]", "n"],
        TraditionalForm], 
       RowBox[{"J", 
        RowBox[{"(", 
         RowBox[{"n3", "-", "n"}], ")"}], 
        SubscriptBox["c", 
         RowBox[{"n1", ",", " ", "n2", ",", " ", "n"}]]}]}]}]}]}], 
   "DisplayFormula",
   FontColor->RGBColor[1, 0, 0]], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"It", " ", "is", " ", "easy", " ", "to", " ", "verify", " ", "the", 
  " ", "above", " ", "equation", " ", "is", " ", "hold", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"assumming", " ", "that", " ", 
     SubscriptBox["c", 
      RowBox[{"n1", ",", "n2", ",", "n3"}]], " ", "is", " ", "zero", " ", 
     "if", " ", "any", " ", "two", " ", "of", " ", "n1"}], ",", " ", "n2", 
    ",", " ", 
    RowBox[{"n3", " ", "are", " ", "equal"}]}], " ", 
   ")"}]}]}], "DisplayFormula",
 CellChangeTimes->{{3.5407586444694767`*^9, 3.540759057322523*^9}, {
   3.540759099583181*^9, 3.5407592219154797`*^9}, {3.54075925449498*^9, 
   3.540759256376958*^9}, {3.540759286529578*^9, 3.540759636984414*^9}, {
   3.540759677178377*^9, 3.540759855340365*^9}, {3.540760241668561*^9, 
   3.540760243109877*^9}, 3.540760406546316*^9, {3.5408389810667057`*^9, 
   3.540839447796838*^9}, {3.540839504608433*^9, 3.540839517244543*^9}, 
   3.540839607917955*^9, {3.540839648368043*^9, 3.5408397140259533`*^9}},
 TextAlignment->Left,
 TextJustification->1,
 Background->RGBColor[1, 1, 0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Now the Schrodinger equation has been reduced in site representation. In the \
next step, we will convert it into wave vector representation \
\>", "Subtitle",
 CellChangeTimes->{{3.540760547125939*^9, 3.540760609925701*^9}},
 Background->RGBColor[1, 1, 0]],

Cell["\<\
At this point, it is better to work with the derivations by hand. We consider \
the above Schrodinger - like equation (including kinematic interaction) term \
by term.\
\>", "Text",
 CellChangeTimes->{{3.540840265202084*^9, 3.540840292557246*^9}, {
   3.540840337960774*^9, 3.540840342070936*^9}, {3.5408403991790743`*^9, 
   3.540840439474066*^9}, 3.540840513591631*^9},
 TextJustification->1,
 Background->RGBColor[1, 1, 0.85]],

Cell["Making use of the Fourier transform:", "Text",
 CellChangeTimes->{{3.540840522683271*^9, 3.540840541923645*^9}}],

Cell[BoxData[{
 RowBox[{
  SubscriptBox["c", 
   RowBox[{"n1", ",", " ", "n2", ",", " ", "n3"}]], "=", 
  RowBox[{
   SubscriptBox["\[Sum]", 
    RowBox[{"k1", ",", "k2", ",", "k3"}]], 
   RowBox[{
    SuperscriptBox["e", 
     RowBox[{"i", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
        RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
        RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "c", 
    RowBox[{"(", 
     RowBox[{"k1", ",", "k2", ",", "k3"}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"and", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Sum]", "n"], 
    RowBox[{
     SuperscriptBox["e", 
      RowBox[{"ik", 
       RowBox[{"(", 
        RowBox[{"n", "-", "m"}], ")"}]}]], "J", 
     RowBox[{"(", 
      RowBox[{"n", "-", "m"}], ")"}]}]}], "=", 
   RowBox[{"J", 
    RowBox[{"(", "k", ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"k", " ", "is", " ", "a", " ", "wave", " ", "vector"}], 
     ")"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"and", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Sum]", "n"], 
   RowBox[{
    SuperscriptBox["e", 
     RowBox[{"ik", 
      RowBox[{"(", 
       RowBox[{"n", "-", "m"}], ")"}]}]], "D", 
    RowBox[{"(", 
     RowBox[{"n", "-", "m"}], ")"}]}]}], "=", 
  RowBox[{"D", 
   RowBox[{"(", "k", ")"}]}]}]}], "DisplayFormula",
 CellChangeTimes->{{3.54084057288102*^9, 3.5408405853036947`*^9}, {
  3.5408406261539288`*^9, 3.540840839137273*^9}, {3.601952711625757*^9, 
  3.6019527120317802`*^9}},
 Background->RGBColor[1, 1, 0.85]],

Cell["and the orthonormality relation", "Text",
 CellChangeTimes->{{3.540840860896286*^9, 3.540840870966248*^9}, {
  3.540840957971404*^9, 3.540840965057167*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Delta]", 
   RowBox[{"n", ",", "m"}]], "=", 
  RowBox[{
   FractionBox["1", "N"], 
   RowBox[{
    SubscriptBox["\[Sum]", "k"], 
    SuperscriptBox["e", 
     RowBox[{"ik", 
      RowBox[{"(", 
       RowBox[{"n", "-", "m"}], ")"}]}]]}]}]}]], "DisplayFormula",
 CellChangeTimes->{{3.540840981478559*^9, 3.540841041918436*^9}},
 Background->RGBColor[1, 1, 0.85]],

Cell["we are ready to convert the equation term by term.", "Text",
 CellChangeTimes->{{3.540841076946621*^9, 3.540841110990024*^9}}],

Cell[BoxData[{
 RowBox[{
  FormBox[
   SubscriptBox["\[Sum]", "n"],
   TraditionalForm], 
  RowBox[{"J", 
   RowBox[{"(", 
    RowBox[{"n", "-", " ", "n1"}], ")"}], 
   SubscriptBox["c", 
    RowBox[{"n", ",", " ", "n2", ",", " ", "n3"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{"=", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox["N"], ")"}], "3"]], 
   FormBox[
    RowBox[{"\[Cross]", 
     SubscriptBox["\[Sum]", "n"]}],
    TraditionalForm], 
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"k1", ",", "k2", ",", "k3"}]], 
    RowBox[{"J", 
     RowBox[{"(", 
      RowBox[{"n", "-", " ", "n1"}], ")"}], 
     SuperscriptBox["e", 
      RowBox[{"i", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1", " ", "n"}], " ", "+", " ", 
         RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
         RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "c", 
     RowBox[{"(", 
      RowBox[{"k1", ",", "k2", ",", "k3"}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"=", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox["N"], ")"}], "3"]], 
   FormBox[
    RowBox[{"\[Cross]", 
     SubscriptBox["\[Sum]", "n"]}],
    TraditionalForm], 
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"k1", ",", "k2", ",", "k3"}]], 
    RowBox[{"J", 
     RowBox[{"(", 
      RowBox[{"n", "-", " ", "n1"}], ")"}], 
     SuperscriptBox["e", 
      RowBox[{"ik1", 
       RowBox[{"(", 
        RowBox[{"n", "-", "n1"}], ")"}]}]], 
     SuperscriptBox["e", 
      RowBox[{"i", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
         RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
         RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "c", 
     RowBox[{"(", 
      RowBox[{"k1", ",", "k2", ",", "k3"}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox["N"], ")"}], "3"]], 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"k1", ",", "k2", ",", "k3"}]], 
     RowBox[{"J", 
      RowBox[{"(", "k1", ")"}], 
      SuperscriptBox["e", 
       RowBox[{"i", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
          RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
          RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "c", 
      RowBox[{"(", 
       RowBox[{"k1", ",", "k2", ",", "k3"}], ")"}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "For", " ", "the", " ", "other", " ", "two", " ", "similar", " ", "terms"}],
   ",", 
  RowBox[{"we", " ", "can", " ", "do", " ", "the", " ", "similar", " ", 
   RowBox[{"things", ".", " ", "Then"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   FormBox[
    SubscriptBox["\[Sum]", "n"],
    TraditionalForm], 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"J", 
      RowBox[{"(", 
       RowBox[{"n", "-", " ", "n1"}], ")"}], 
      SubscriptBox["c", 
       RowBox[{"n", ",", " ", "n2", ",", " ", "n3"}]]}], " ", "+", 
     RowBox[{"J", 
      RowBox[{"(", 
       RowBox[{"n", "-", " ", "n2"}], ")"}], 
      SubscriptBox["c", 
       RowBox[{"n1", ",", " ", "n", ",", " ", "n3"}]]}], " ", "+", " ", 
     RowBox[{"J", 
      RowBox[{"(", 
       RowBox[{"n", ",", " ", "n3"}], ")"}], 
      SubscriptBox["c", 
       RowBox[{"n1", ",", " ", "n2", ",", " ", "n"}]]}]}], "]"}]}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox["N"], ")"}], "3"]], 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"k1", ",", "k2", ",", "k3"}]], 
     RowBox[{
      RowBox[{"[", 
       RowBox[{
        RowBox[{"J", 
         RowBox[{"(", "k1", ")"}]}], "+", 
        RowBox[{"J", 
         RowBox[{"(", "k2", ")"}]}], "+", 
        RowBox[{"J", 
         RowBox[{"(", "k3", ")"}]}]}], "]"}], 
      SuperscriptBox["e", 
       RowBox[{"i", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
          RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
          RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "c", 
      RowBox[{"(", 
       RowBox[{"k1", ",", "k2", ",", "k3"}], ")"}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "If", " ", "we", " ", "add", " ", "the", " ", "above", " ", "term", " ", 
   "to", " ", "the", " ", "first", " ", "term", " ", "of", " ", "LHS"}], ",", 
  " ", 
  RowBox[{"we", " ", "obtain"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FormBox[
       RowBox[{"3", 
        SubscriptBox["\[Epsilon]", "0"]}],
       TraditionalForm], " ", "-", "  ", "\[Epsilon]"}], ")"}], " ", 
    FormBox[
     SubscriptBox["c", 
      RowBox[{"n1", ",", "n2", ",", "n3"}]],
     TraditionalForm]}], " ", "+", " ", 
   RowBox[{
    FormBox[
     SubscriptBox["\[Sum]", "n"],
     TraditionalForm], 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"J", 
       RowBox[{"(", 
        RowBox[{"n", "-", " ", "n1"}], ")"}], 
       SubscriptBox["c", 
        RowBox[{"n", ",", " ", "n2", ",", " ", "n3"}]]}], " ", "+", " ", 
      RowBox[{"J", 
       RowBox[{"(", 
        RowBox[{"n", "-", " ", "n2"}], ")"}], 
       SubscriptBox["c", 
        RowBox[{"n1", ",", " ", "n", ",", " ", "n3"}]]}], " ", "+", " ", 
      RowBox[{"J", 
       RowBox[{"(", 
        RowBox[{"n", ",", " ", "n3"}], ")"}], 
       SubscriptBox["c", 
        RowBox[{"n1", ",", " ", "n2", ",", " ", "n"}]]}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox["N"], ")"}], "3"]], 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"k1", ",", "k2", ",", "k3"}]], 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"[", 
         RowBox[{
          SubscriptBox["\[Epsilon]", "0"], "+", 
          RowBox[{"J", 
           RowBox[{"(", "k1", ")"}]}]}], "]"}], "+", 
        RowBox[{"[", 
         RowBox[{
          SubscriptBox["\[Epsilon]", "0"], "+", 
          RowBox[{"J", 
           RowBox[{"(", "k2", ")"}]}]}], "]"}], "+", 
        RowBox[{"[", 
         RowBox[{
          SubscriptBox["\[Epsilon]", "0"], "+", 
          RowBox[{"J", 
           RowBox[{"(", "k3", ")"}]}]}], "]"}], "-", 
        SubscriptBox["\[Epsilon]", "trimer"]}], "}"}], 
      SuperscriptBox["e", 
       RowBox[{"i", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
          RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
          RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "c", 
      RowBox[{"(", 
       RowBox[{"k1", ",", "k2", ",", "k3"}], ")"}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox["N"], ")"}], "3"]], 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"k1", ",", "k2", ",", "k3"}]], 
     RowBox[{
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Epsilon]", "exciton"], 
         RowBox[{"(", "k1", ")"}]}], "+", " ", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "exciton"], 
         RowBox[{"(", "k1", ")"}]}], "+", " ", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "exciton"], 
         RowBox[{"(", "k1", ")"}]}], "-", 
        SubscriptBox["\[Epsilon]", "trimer"]}], "]"}], 
      SuperscriptBox["e", 
       RowBox[{"i", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
          RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
          RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "c", 
      RowBox[{"(", 
       RowBox[{"k1", ",", "k2", ",", "k3"}], ")"}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"The", " ", "energy", " ", 
    SubscriptBox["\[Epsilon]", 
     RowBox[{"trimer", " "}]], "is", " ", "for", " ", "bound", " ", "or", " ",
     "free", " ", "three"}], "-", 
   RowBox[{"body", " ", "states"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Now", " ", "consider", " ", "the", " ", "term", " ", "associated", 
  " ", "with", " ", "D", " ", "in", " ", "LHS"}], "\[IndentingNewLine]", 
 RowBox[{
  FormBox[
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]],
   TraditionalForm], " ", "D", 
  RowBox[{"(", 
   RowBox[{"n1", "-", "n2"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox["N"], ")"}], "3"]], 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"k1", ",", "k2", ",", "k3"}]], 
     RowBox[{"c", 
      RowBox[{"(", 
       RowBox[{"k1", ",", "k2", ",", "k3"}], ")"}], 
      SuperscriptBox["e", 
       RowBox[{"i", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
          RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
          RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "D", 
      RowBox[{"(", 
       RowBox[{"n1", "-", "n2"}], ")"}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"=", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"(", 
      SqrtBox["N"], ")"}], "3"]], 
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"k1", ",", "k2", ",", "k3"}]], 
    RowBox[{"c", 
     RowBox[{"(", 
      RowBox[{"k1", ",", "k2", ",", "k3"}], ")"}], 
     SuperscriptBox["e", 
      RowBox[{"i", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
         RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
         RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "  ", 
     FractionBox["1", "N"], 
     RowBox[{
      SubscriptBox["\[Sum]", "q"], 
      RowBox[{
       SuperscriptBox["e", 
        RowBox[{"iq", 
         RowBox[{"(", 
          RowBox[{"n1", "-", "n2"}], ")"}]}]], "D", 
       RowBox[{"(", "q", ")"}]}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"N", 
      SuperscriptBox[
       RowBox[{"(", 
        SqrtBox["N"], ")"}], "3"]}]], 
    RowBox[{
     SubscriptBox["\[Sum]", "q"], 
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{"k1", ",", "k2", ",", "k3"}]], 
      RowBox[{"c", 
       RowBox[{"(", 
        RowBox[{"k1", ",", "k2", ",", "k3"}], ")"}], 
       SuperscriptBox["e", 
        RowBox[{
         RowBox[{"i", 
          RowBox[{"(", 
           RowBox[{"k1", "+", "q"}], ")"}], "n1"}], " ", "+", " ", 
         RowBox[{"i", 
          RowBox[{"(", 
           RowBox[{"k2", "-", "q"}], ")"}], "n2"}], "+", 
         RowBox[{"ik3", " ", "n3"}]}]], "D", 
       RowBox[{"(", "q", ")"}]}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "do", " ", "some", " ", "tricks", " ", "with", " ", "the", " ", "index", 
    " ", "k1"}], ",", " ", 
   RowBox[{"k2", " ", "and", " ", "k3"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"assume", " ", 
     RowBox[{"k1", "'"}]}], "=", 
    RowBox[{"k1", "+", "q"}]}], ",", " ", 
   RowBox[{
    RowBox[{"k2", "'"}], "=", 
    RowBox[{"k2", "-", "q"}]}], ",", " ", "then"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"N", 
      SuperscriptBox[
       RowBox[{"(", 
        SqrtBox["N"], ")"}], "3"]}]], 
    RowBox[{
     SubscriptBox["\[Sum]", "q"], 
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{
        RowBox[{"k1", "'"}], ",", 
        RowBox[{"k2", "'"}], ",", "k3"}]], "\[IndentingNewLine]", 
      RowBox[{"c", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"k1", "'"}], "-", "q"}], ",", 
         RowBox[{
          RowBox[{"k2", "'"}], "+", "q"}], ",", "k3"}], ")"}], 
       SuperscriptBox["e", 
        RowBox[{
         RowBox[{
          RowBox[{"ik1", "'"}], "n1"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"ik2", "'"}], "n2"}], "+", 
         RowBox[{"ik3", " ", "n3"}]}]], "D", 
       RowBox[{"(", "q", ")"}]}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"N", 
      SuperscriptBox[
       RowBox[{"(", 
        SqrtBox["N"], ")"}], "3"]}]], 
    RowBox[{
     SubscriptBox["\[Sum]", "q"], 
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{"k1", ",", "k2", ",", "k3"}]], "\[IndentingNewLine]", 
      RowBox[{"c", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1", "-", "q"}], ",", 
         RowBox[{"k2", "+", "q"}], ",", "k3"}], ")"}], 
       SuperscriptBox["e", 
        RowBox[{"i", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
           RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
           RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "D", 
       RowBox[{"(", "q", ")"}]}]}]}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "Then", \
"\[IndentingNewLine]", 
 RowBox[{
  FormBox[
   SubscriptBox["c", 
    RowBox[{"n1", ",", "n2", ",", "n3"}]],
   TraditionalForm], "[", " ", 
  RowBox[{
   RowBox[{"D", 
    RowBox[{"(", 
     RowBox[{"n1", "-", "n2"}], ")"}]}], " ", "+", " ", 
   RowBox[{"D", 
    RowBox[{"(", 
     RowBox[{"n1", "-", "n3"}], ")"}]}], " ", "+", " ", 
   RowBox[{"D", 
    RowBox[{"(", 
     RowBox[{"n2", "-", "n3"}], ")"}]}]}], " ", "]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"N", 
      SuperscriptBox[
       RowBox[{"(", 
        SqrtBox["N"], ")"}], "3"]}]], 
    RowBox[{
     SubscriptBox["\[Sum]", "q"], 
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{"k1", ",", "k2", ",", "k3"}]], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"[", 
        RowBox[{
         RowBox[{"c", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k1", "-", "q"}], ",", 
            RowBox[{"k2", "+", "q"}], ",", "k3"}], ")"}]}], "+", 
         RowBox[{"c", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k1", "-", "q"}], ",", "k2", ",", 
            RowBox[{"k3", "+", "q"}]}], ")"}]}], "+", 
         RowBox[{"c", 
          RowBox[{"(", 
           RowBox[{"k1", ",", 
            RowBox[{"k2", "-", "q"}], ",", 
            RowBox[{"k3", "+", "q"}]}], ")"}]}]}], "]"}], 
       SuperscriptBox["e", 
        RowBox[{"i", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
           RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
           RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "D", 
       RowBox[{"(", "q", ")"}]}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Now", " ", "the", " ", "LHS"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox["N"], ")"}], "3"]], 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"k1", ",", "k2", ",", "k3"}]], 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"i", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
          RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
          RowBox[{"k3", " ", "n3"}]}], ")"}]}]], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Epsilon]", "exciton"], 
            RowBox[{"(", "k1", ")"}]}], "+", " ", 
           RowBox[{
            SubscriptBox["\[Epsilon]", "exciton"], 
            RowBox[{"(", "k1", ")"}]}], "+", " ", 
           RowBox[{
            SubscriptBox["\[Epsilon]", "exciton"], 
            RowBox[{"(", "k1", ")"}]}], "-", 
           SubscriptBox["\[Epsilon]", "trimer"]}], "]"}], "c", 
         RowBox[{"(", 
          RowBox[{"k1", ",", "k2", ",", "k3"}], ")"}]}], "+", " ", 
        RowBox[{
         FractionBox["1", "N"], 
         RowBox[{
          SubscriptBox["\[Sum]", "q"], 
          RowBox[{
           RowBox[{"[", 
            RowBox[{
             RowBox[{"c", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"k1", "-", "q"}], ",", 
                RowBox[{"k2", "+", "q"}], ",", "k3"}], ")"}]}], "+", 
             RowBox[{"c", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"k1", "-", "q"}], ",", "k2", ",", 
                RowBox[{"k3", "+", "q"}]}], ")"}]}], "+", 
             RowBox[{"c", 
              RowBox[{"(", 
               RowBox[{"k1", ",", 
                RowBox[{"k2", "-", "q"}], ",", 
                RowBox[{"k3", "+", "q"}]}], ")"}]}]}], "]"}], "D", 
           RowBox[{"(", "q", ")"}]}]}]}]}], "}"}]}]}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"We", " ", "turn", " ", "to", " ", "RHS", " ", "of", " ", "the", " ",
   "equation"}], "\[IndentingNewLine]", 
 RowBox[{"2", 
  SubscriptBox["\[Delta]", 
   RowBox[{"n1", ",", "n2"}]], 
  RowBox[{
   FormBox[
    SubscriptBox["\[Sum]", "n"],
    TraditionalForm], 
   RowBox[{"J", 
    RowBox[{"(", 
     RowBox[{"n1", "-", "n"}], ")"}], 
    SubscriptBox["c", 
     RowBox[{
     "n", ",", " ", "n2", ",", " ", "n3"}]]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"=", 
  RowBox[{
   FractionBox["2", "N"], 
   RowBox[{
    FormBox[
     SubscriptBox["\[Sum]", "q"],
     TraditionalForm], 
    RowBox[{
     SuperscriptBox["e", 
      RowBox[{"iq", 
       RowBox[{"(", 
        RowBox[{"n1", "-", "n2"}], ")"}]}]], 
     RowBox[{
      FormBox[
       SubscriptBox["\[Sum]", "n"],
       TraditionalForm], 
      RowBox[{"J", 
       RowBox[{"(", 
        RowBox[{"n1", "-", "n"}], ")"}], 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          SqrtBox["N"], ")"}], "3"]], 
       RowBox[{
        SubscriptBox["\[Sum]", 
         RowBox[{"k1", ",", "k2", ",", "k3"}]], 
        RowBox[{
         SuperscriptBox["e", 
          RowBox[{"i", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k1", " ", "n"}], " ", "+", " ", 
             RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
             RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "c", 
         RowBox[{"(", 
          RowBox[{"k1", ",", "k2", ",", "k3"}], 
          ")"}]}]}]}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"=", 
  RowBox[{
   FractionBox["2", 
    RowBox[{"N", 
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox["N"], ")"}], "3"]}]], 
   RowBox[{
    FormBox[
     SubscriptBox["\[Sum]", "q"],
     TraditionalForm], 
    RowBox[{
     SuperscriptBox["e", 
      RowBox[{"iq", 
       RowBox[{"(", 
        RowBox[{"n1", "-", "n2"}], ")"}]}]], 
     FormBox[
      RowBox[{
       SubscriptBox["\[Sum]", 
        RowBox[{"k1", ",", "k2", ",", "k3"}]], 
       SubscriptBox["\[Sum]", "n"]}],
      TraditionalForm], "J", 
     RowBox[{"(", 
      RowBox[{"n1", "-", "n"}], ")"}], 
     SuperscriptBox["e", 
      RowBox[{"ik1", 
       RowBox[{"(", 
        RowBox[{"n", "-", "n1"}], ")"}]}]], 
     SuperscriptBox["e", 
      RowBox[{"i", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
         RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
         RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "c", 
     RowBox[{"(", 
      RowBox[{"k1", ",", "k2", ",", "k3"}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"=", 
  RowBox[{
   FractionBox["2", 
    RowBox[{"N", 
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox["N"], ")"}], "3"]}]], 
   RowBox[{
    FormBox[
     SubscriptBox["\[Sum]", "q"],
     TraditionalForm], 
    RowBox[{
     SuperscriptBox["e", 
      RowBox[{"iq", 
       RowBox[{"(", 
        RowBox[{"n1", "-", "n2"}], ")"}]}]], 
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{"k1", ",", "k2", ",", "k3"}]], 
      RowBox[{"J", 
       RowBox[{"(", "k1", ")"}], 
       SuperscriptBox["e", 
        RowBox[{"i", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
           RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
           RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "c", 
       RowBox[{"(", 
        RowBox[{"k1", ",", "k2", ",", "k3"}], 
        ")"}]}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"=", 
  RowBox[{
   FractionBox["2", 
    RowBox[{"N", 
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox["N"], ")"}], "3"]}]], 
   FormBox[
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"k1", ",", "k2", ",", "k3"}]], 
     SubscriptBox["\[Sum]", "q"]}],
    TraditionalForm], "J", 
   RowBox[{"(", "k1", ")"}], 
   SuperscriptBox["e", 
    RowBox[{
     RowBox[{"i", 
      RowBox[{"(", 
       RowBox[{"k1", "+", "q"}], ")"}], " ", "n1"}], " ", "+", " ", 
     RowBox[{"i", 
      RowBox[{"(", 
       RowBox[{"k2", "-", "q"}], ")"}], " ", "n2"}], " ", "+", 
     RowBox[{"i", " ", "k3", " ", "n3"}]}]], "c", 
   RowBox[{"(", 
    RowBox[{"k1", ",", "k2", ",", "k3"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Do", " ", "the", " ", "same", " ", "trick", " ", "as", " ", "we", " ", 
   "did", " ", "for", " ", "the", " ", "term", " ", "associated", " ", "with",
    " ", "D"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FractionBox["2", 
     RowBox[{"N", 
      SuperscriptBox[
       RowBox[{"(", 
        SqrtBox["N"], ")"}], "3"]}]], 
    FormBox[
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{"k1", ",", "k2", ",", "k3"}]], 
      SubscriptBox["\[Sum]", "q"]}],
     TraditionalForm], "J", 
    RowBox[{"(", 
     RowBox[{"k1", "-", "q"}], ")"}], 
    SuperscriptBox["e", 
     RowBox[{"i", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
        RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
        RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "c", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k1", "-", "q"}], ",", 
      RowBox[{"k2", "+", "q"}], ",", "k3"}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Therefore", ",", " ", 
  RowBox[{"the", " ", "RHS"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"=", 
   RowBox[{
    FractionBox["2", 
     RowBox[{"N", 
      SuperscriptBox[
       RowBox[{"(", 
        SqrtBox["N"], ")"}], "3"]}]], 
    FormBox[
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{"k1", ",", "k2", ",", "k3"}]], 
      SubscriptBox["\[Sum]", "q"]}],
     TraditionalForm], 
    RowBox[{
     SuperscriptBox["e", 
      RowBox[{"i", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1", " ", "n1"}], " ", "+", " ", 
         RowBox[{"k2", " ", "n2"}], " ", "+", " ", 
         RowBox[{"k3", " ", "n3"}]}], ")"}]}]], "[", 
     RowBox[{
      RowBox[{"J", 
       RowBox[{"(", 
        RowBox[{"k1", "-", "q"}], ")"}], "c", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1", "-", "q"}], ",", 
         RowBox[{"k2", "+", "q"}], ",", "k3"}], ")"}]}], "+", 
      RowBox[{"J", 
       RowBox[{"(", 
        RowBox[{"k2", "-", "q"}], ")"}], "c", 
       RowBox[{"(", 
        RowBox[{"k1", ",", 
         RowBox[{"k2", "-", "q"}], ",", 
         RowBox[{"k3", "+", "q"}]}], ")"}]}], "+", 
      RowBox[{"J", 
       RowBox[{"(", 
        RowBox[{"k3", "-", "q"}], ")"}], "c", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1", "+", "q"}], ",", 
         RowBox[{"k2", "+", "q"}], ",", 
         RowBox[{"k3", "-", "q"}]}], ")"}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Comparing", " ", "LHS", " ", "and", " ", "RHS"}], ",", " ", 
   RowBox[{
    RowBox[{"we", " ", "can", " ", "obtain", " ", "the", " ", "Schrodinger"}],
     "-", 
    RowBox[{
    "like", " ", "equation", " ", "in", " ", "k", " ", "representation"}]}]}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Epsilon]", "exciton"], 
       RowBox[{"(", "k1", ")"}]}], "+", " ", 
      RowBox[{
       SubscriptBox["\[Epsilon]", "exciton"], 
       RowBox[{"(", "k1", ")"}]}], "+", " ", 
      RowBox[{
       SubscriptBox["\[Epsilon]", "exciton"], 
       RowBox[{"(", "k1", ")"}]}], "-", 
      SubscriptBox["\[Epsilon]", "trimer"]}], "]"}], "c", 
    RowBox[{"(", 
     RowBox[{"k1", ",", "k2", ",", "k3"}], ")"}]}], "+", " ", 
   RowBox[{
    FractionBox["1", "N"], 
    RowBox[{
     SubscriptBox["\[Sum]", "q"], 
     RowBox[{
      RowBox[{"[", 
       RowBox[{
        RowBox[{"c", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", "-", "q"}], ",", 
           RowBox[{"k2", "+", "q"}], ",", "k3"}], ")"}]}], "+", 
        RowBox[{"c", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", "-", "q"}], ",", "k2", ",", 
           RowBox[{"k3", "+", "q"}]}], ")"}]}], "+", 
        RowBox[{"c", 
         RowBox[{"(", 
          RowBox[{"k1", ",", 
           RowBox[{"k2", "-", "q"}], ",", 
           RowBox[{"k3", "+", "q"}]}], ")"}]}]}], "]"}], "D", 
      RowBox[{"(", "q", ")"}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"=", 
  RowBox[{
   FractionBox["2", "N"], 
   RowBox[{
    SubscriptBox["\[Sum]", "q"], 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"J", 
       RowBox[{"(", 
        RowBox[{"k1", "-", "q"}], ")"}], "c", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1", "-", "q"}], ",", 
         RowBox[{"k2", "+", "q"}], ",", "k3"}], ")"}]}], "+", 
      RowBox[{"J", 
       RowBox[{"(", 
        RowBox[{"k2", "-", "q"}], ")"}], "c", 
       RowBox[{"(", 
        RowBox[{"k1", ",", 
         RowBox[{"k2", "-", "q"}], ",", 
         RowBox[{"k3", "+", "q"}]}], ")"}]}], "+", 
      RowBox[{"J", 
       RowBox[{"(", 
        RowBox[{"k3", "-", "q"}], ")"}], "c", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1", "+", "q"}], ",", 
         RowBox[{"k2", "+", "q"}], ",", 
         RowBox[{"k3", "-", "q"}]}], ")"}]}]}], 
     "]"}]}]}]}]}], "DisplayFormula",
 CellChangeTimes->{
  3.540840474629405*^9, {3.540841127072525*^9, 3.540841193612232*^9}, {
   3.540841237443205*^9, 3.54084128964119*^9}, {3.54084131993505*^9, 
   3.540841678805496*^9}, {3.5408417361802387`*^9, 3.5408417435927753`*^9}, {
   3.5408417934600773`*^9, 3.540842188420928*^9}, {3.5408422225634127`*^9, 
   3.5408422974894238`*^9}, {3.540842394343544*^9, 3.540842443015061*^9}, {
   3.540842483003152*^9, 3.5408426022583227`*^9}, {3.5408426352125063`*^9, 
   3.540843163596449*^9}, {3.540843258765945*^9, 3.540843294381776*^9}, {
   3.540843533610023*^9, 3.5408435934673347`*^9}, {3.540843660362846*^9, 
   3.540843668767275*^9}, 3.54084402467955*^9, {3.54084407092657*^9, 
   3.540844290599361*^9}, {3.540844325327105*^9, 3.540844370834428*^9}, {
   3.540844414097427*^9, 3.540844506867264*^9}, {3.540844559754551*^9, 
   3.5408445978211813`*^9}, {3.5408446302899303`*^9, 3.540844680378887*^9}, {
   3.6019527277036767`*^9, 3.601952735349114*^9}, {3.601952792659392*^9, 
   3.601952795232539*^9}, 3.601952825726283*^9},
 LineSpacing->{1.5, 3},
 Background->RGBColor[1, 1, 0.85]]
}, Open  ]]
},
WindowSize->{1898, 885},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
FrontEndVersion->"7.0 for Microsoft Windows (64-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 168, 3, 43, "Input"],
Cell[716, 25, 788, 20, 96, "Input"],
Cell[1507, 47, 255, 4, 65, "Text"],
Cell[CellGroupData[{
Cell[1787, 55, 419, 9, 67, "Input"],
Cell[2209, 66, 632, 12, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2878, 83, 259, 7, 67, "Input"],
Cell[3140, 92, 465, 10, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3642, 107, 239, 7, 67, "Input"],
Cell[3884, 116, 465, 10, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4386, 131, 294, 8, 67, "Input"],
Cell[4683, 141, 695, 16, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5415, 162, 438, 12, 67, "Input"],
Cell[5856, 176, 2200, 35, 142, "Output"]
}, Open  ]],
Cell[8071, 214, 546, 12, 67, "Text"],
Cell[8620, 228, 3633, 78, 177, "Input"],
Cell[12256, 308, 201, 3, 65, "Text"],
Cell[CellGroupData[{
Cell[12482, 315, 413, 13, 73, "Input"],
Cell[12898, 330, 616, 15, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13551, 350, 467, 14, 73, "Input"],
Cell[14021, 366, 666, 17, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14724, 388, 468, 15, 73, "Input"],
Cell[15195, 405, 664, 17, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15896, 427, 426, 13, 73, "Input"],
Cell[16325, 442, 647, 16, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17009, 463, 482, 15, 73, "Input"],
Cell[17494, 480, 704, 18, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18235, 503, 506, 15, 73, "Input"],
Cell[18744, 520, 734, 18, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19515, 543, 368, 8, 46, "Input"],
Cell[19886, 553, 413, 8, 45, "Output"]
}, Open  ]],
Cell[20314, 564, 178, 3, 65, "Text"],
Cell[CellGroupData[{
Cell[20517, 571, 817, 24, 73, "Input"],
Cell[21337, 597, 410, 7, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21784, 609, 701, 22, 73, "Input"],
Cell[22488, 633, 634, 14, 73, "Output"]
}, Open  ]],
Cell[23137, 650, 316, 6, 65, "Text"],
Cell[CellGroupData[{
Cell[23478, 660, 765, 23, 73, "Input"],
Cell[24246, 685, 887, 24, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25170, 714, 884, 26, 73, "Input"],
Cell[26057, 742, 365, 6, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26459, 753, 1508, 45, 73, "Input"],
Cell[27970, 800, 1587, 46, 73, "Output"]
}, Open  ]],
Cell[29572, 849, 279, 6, 65, "Text"],
Cell[29854, 857, 197, 3, 65, "Text"],
Cell[30054, 862, 1428, 35, 284, "Input"],
Cell[CellGroupData[{
Cell[31507, 901, 1430, 43, 73, "Input"],
Cell[32940, 946, 911, 25, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33888, 976, 192, 4, 98, "Subtitle"],
Cell[34083, 982, 2887, 73, 312, "Input"],
Cell[36973, 1057, 1251, 34, 209, "Input"],
Cell[38227, 1093, 182, 4, 41, "Text"],
Cell[CellGroupData[{
Cell[38434, 1101, 1580, 37, 71, "Input"],
Cell[40017, 1140, 1427, 35, 53, "Output"]
}, Open  ]],
Cell[41459, 1178, 185, 2, 41, "Text"],
Cell[CellGroupData[{
Cell[41669, 1184, 1332, 39, 70, "Input"],
Cell[43004, 1225, 1842, 52, 79, "Output"]
}, Open  ]],
Cell[44861, 1280, 261, 5, 41, "Text"],
Cell[CellGroupData[{
Cell[45147, 1289, 956, 28, 70, "Input"],
Cell[46106, 1319, 1476, 39, 62, "Output"]
}, Open  ]],
Cell[47597, 1361, 634, 12, 42, "Text"],
Cell[48234, 1375, 209, 4, 41, "Text"],
Cell[CellGroupData[{
Cell[48468, 1383, 597, 15, 125, "Input"],
Cell[49068, 1400, 1279, 32, 79, "Output"]
}, Open  ]],
Cell[50362, 1435, 306, 6, 41, "Text"],
Cell[CellGroupData[{
Cell[50693, 1445, 425, 10, 43, "Input"],
Cell[51121, 1457, 1110, 24, 49, "Output"]
}, Open  ]],
Cell[52246, 1484, 293, 9, 41, "Text"],
Cell[CellGroupData[{
Cell[52564, 1497, 626, 15, 125, "Input"],
Cell[53193, 1514, 2499, 71, 62, "Output"]
}, Open  ]],
Cell[55707, 1588, 240, 5, 41, "Text"],
Cell[CellGroupData[{
Cell[55972, 1597, 282, 5, 43, "Input"],
Cell[56257, 1604, 730, 21, 49, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57036, 1631, 164, 2, 98, "Subtitle"],
Cell[CellGroupData[{
Cell[57225, 1637, 283, 7, 43, "Input"],
Cell[57511, 1646, 2019, 61, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59567, 1712, 226, 4, 43, "Input"],
Cell[59796, 1718, 1966, 59, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61799, 1782, 280, 7, 43, "Input"],
Cell[62082, 1791, 4480, 139, 113, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66599, 1935, 203, 4, 43, "Input"],
Cell[66805, 1941, 4358, 135, 113, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71200, 2081, 231, 6, 43, "Input"],
Cell[71434, 2089, 9701, 303, 209, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81172, 2397, 203, 4, 43, "Input"],
Cell[81378, 2403, 9460, 295, 177, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90875, 2703, 213, 4, 43, "Input"],
Cell[91091, 2709, 4096, 127, 81, "Output"]
}, Open  ]],
Cell[95202, 2839, 700, 17, 42, "Text"],
Cell[CellGroupData[{
Cell[95927, 2860, 715, 21, 46, "Input"],
Cell[96645, 2883, 1765, 53, 49, "Output"]
}, Open  ]],
Cell[98425, 2939, 187, 4, 41, "Text"],
Cell[CellGroupData[{
Cell[98637, 2947, 548, 16, 49, "Input"],
Cell[99188, 2965, 635, 18, 49, "Output"]
}, Open  ]],
Cell[99838, 2986, 174, 3, 125, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100049, 2994, 215, 3, 98, "Subtitle"],
Cell[CellGroupData[{
Cell[100289, 3001, 310, 6, 43, "Input"],
Cell[100602, 3009, 2888, 82, 94, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103527, 3096, 592, 9, 43, "Input"],
Cell[104122, 3107, 4419, 126, 94, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108578, 3238, 303, 5, 43, "Input"],
Cell[108884, 3245, 4569, 141, 140, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113490, 3391, 275, 5, 43, "Input"],
Cell[113768, 3398, 4400, 136, 139, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118205, 3539, 162, 3, 43, "Input"],
Cell[118370, 3544, 6495, 204, 203, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124902, 3753, 188, 4, 43, "Input"],
Cell[125093, 3759, 11528, 366, 327, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136658, 4130, 154, 3, 43, "Input"],
Cell[136815, 4135, 11149, 354, 327, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148001, 4494, 350, 6, 71, "Input"],
Cell[148354, 4502, 11213, 355, 327, "Output"]
}, Open  ]],
Cell[159582, 4860, 324, 8, 43, "Input"],
Cell[CellGroupData[{
Cell[159931, 4872, 250, 5, 43, "Input"],
Cell[160184, 4879, 44648, 1422, 1066, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204869, 6306, 1612, 39, 99, "Input"],
Cell[206484, 6347, 15370, 488, 403, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221891, 6840, 1037, 27, 152, "Input"],
Cell[222931, 6869, 409, 6, 42, "Output"],
Cell[223343, 6877, 11944, 382, 296, "Output"],
Cell[235290, 7261, 410, 6, 42, "Output"]
}, Open  ]],
Cell[235715, 7270, 1497, 35, 42, "Text"],
Cell[CellGroupData[{
Cell[237237, 7309, 1164, 35, 46, "Input"],
Cell[238404, 7346, 5392, 174, 140, "Output"]
}, Open  ]],
Cell[243811, 7523, 21231, 664, 1281, "DisplayFormula"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265079, 8192, 268, 6, 183, "Subtitle"],
Cell[265350, 8200, 439, 9, 65, "Text"],
Cell[265792, 8211, 118, 1, 41, "Text"],
Cell[265913, 8214, 1645, 50, 273, "DisplayFormula"],
Cell[267561, 8266, 162, 2, 41, "Text"],
Cell[267726, 8270, 403, 13, 76, "DisplayFormula"],
Cell[268132, 8285, 132, 1, 41, "Text"],
Cell[268267, 8288, 27180, 868, 3200, "DisplayFormula"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
